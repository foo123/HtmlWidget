/**
*  HtmlWidget
*  html widgets used as (template) plugins and/or standalone, for PHP, Node/JS, Python
*
*  @dependencies: FontAwesome, SelectorListener, jQuery
*  @version: 0.8.2
*  https://github.com/foo123/HtmlWidget
*  https://github.com/foo123/components.css
*  https://github.com/foo123/jquery-ui-widgets
*  https://github.com/foo123/modelview-widgets
*  https://github.com/foo123/SelectorListener
*
**/
!function(e,t,a){"use strict";function n(e,t){if("object"==typeof t){var a,n,i,l,o,r=0;for(a in t)t[p](a)&&(n=t[a],i=n.selector,l=[].concat(n.rules).join("; "),o=r++,"insertRule"in e.sheet?(e.sheet.insertRule(i+"{"+l+"}",o),n.css=e.sheet.cssRules[o]):"addRule"in e.sheet&&(e.sheet.addRule(i,l,o),n.css=e.sheet.rules[o]))}return t}function l(e,t,a){var i=e.createElement("style");return i.setAttribute("media",t||"all"),i.setAttribute("type","text/css"),i.appendChild(e.createTextNode("")),e.head.appendChild(i),a&&n(i,a),i}function o(e,t){t&&e.head.removeChild(t)}function r(e,n,i){var l=i&&i[f]?i[f]:null;t.fn[e]=function(i){var o,r="string"==typeof i?i:!1,s=m.call(arguments,1),d=this;return r?this.each(function(){var n,i=t.data(this,e);return"widget"===r?(d=i,!1):"instance"===r?(d=i?i.instance||i:i,!1):i?"dispose"===r||"destroy"===r?("function"==typeof i.dispose?i.dispose():"function"==typeof i.destroy?i.destroy():l&&("function"==typeof l.dispose?l.dispose.call(i):"function"==typeof l.destroy&&l.destroy.call(i)),i=null,t.removeData(this,e),!1):(o=i[r]||l&&l[r],"function"!=typeof o?!1:(n=o.apply(i,s),n!==i&&a!==n?(d=n&&n.jquery?d.pushStack(n.get()):n,!1):void 0)):!1}):(i=i||{},this.each(function(){var a=t.data(this,e);a?(o=a.options||l&&l.options,"function"==typeof o&&o.call(a,i)):(t.data(this,e,a=new n(this,i)),o=a.init||l&&l.init,"function"==typeof o&&o.call(a))})),d}}function s(e,t){return"function"==typeof DateX?(t=t||DateX.defaultLocale,function(a){return DateX.format(a,e,t)}):function(e){return e.toDateString()}}function d(e,t){if("function"==typeof DateX){t=t||DateX.defaultLocale;var a=DateX.getParser(e,t);return function(e){return!!e&&a(e)}}return function(e){return new Date(Date.parse(e))}}function c(e,t,a,n,i,l){var o,r,s={map:e,title:n,position:new google.maps.LatLng(t,a)};return"undefined"!==l.clickable&&(s.clickable=!!l.clickable),"undefined"!==l.draggable&&(s.draggable=!!l.draggable),"undefined"!==l.crossOnDrag&&(s.crossOnDrag=!!l.crossOnDrag),"undefined"!==l.visible&&(s.visible=!!l.visible),"undefined"!==l.icon&&(s.icon=l.icon),"undefined"!==l.zIndex&&(s.zIndex=l.zIndex),"undefined"!==l.shape&&(s.shape=l.shape),o=new google.maps.Marker(s),i&&(r=new google.maps.InfoWindow({content:i}),google.maps.event.addListener(o,"click",function(){r.open(e,o)})),o}{var u={VERSION:"0.8.2",widget:{}},p="hasOwnProperty",f="prototype",m=Array[f].slice,h=JSON.parse,g=JSON.stringify;Object[f].toString}t.htmlwidget=u,u.make=r,u.stylable=function w(e,t,a,n,i){var r=this;if(!(r instanceof w))return new w(e,t,a,n,i);var s={id:{selector:a,rules:null}};r.id=t,r.selector=a,r.rules=[];for(var d in n)n[p](d)&&r.rules.push(d+":"+n[d]);s[t].rules=r.rules,r.sheet=l(e,i||"all",s),r.sheet.setAttribute("id",r.id),r.style=s[t].css,r.dispose=function(){r.id=null,r.selector=null,r.rules=null,r.style=null,r.sheet&&o(e,r.sheet),r.sheet=null}},r("selectable",u.selectable=function b(e,a){var n=this;return n instanceof b?(n.init=function(){var n=t(e),i=n.attr("data-selectable-handle")||a.handle||".w-selectable-handle",l=a.selector||a.item;n.hasClass("w-selectable")||n.addClass("w-selectable"),n.on("click.selectable",i,function(e){if(e.shiftKey){var a=t(this);l&&(a=a.closest(l)),a.hasClass("w-selected")?(a.removeClass("w-selected"),a.trigger("deselected")):(a.addClass("w-selected"),a.trigger("selected"))}})},n.clear=function(){t(e).find(".w-selected").removeClass("w-selected")},void(n.dispose=function(){t(e).off(".selectable")})):new b(e,a)}),r("removable",u.removable=function v(e,a){var n=this;return n instanceof v?(n.init=function(){var n=t(e),i=n.attr("data-removable-handle")||a.handle||".w-removable-handle",l=n.attr("data-removable-item")||a.selector||a.item,o=parseInt(n.attr("data-removable-animation")||a.animation||400,10);n.hasClass("w-removable")||n.addClass("w-removable"),n.on("click.removable",i,function(){var e=t(this);l&&(e=e.closest(l)),e.fadeOut(o,function(){e.trigger("removed"),e.remove()})})},void(n.dispose=function(){t(e).off(".removable")})):new v(e,a)}),r("morphable",u.morphable=function y(e,a){var n=this;if(!(n instanceof y))return new y(e,a);var r=null,s=null,d=null;n.create=function(){var n,o,r,c=t(e),u={},p=c.attr("data-morphable-modes")?c.attr("data-morphable-modes").split(","):[].concat(a.modes||[]),f=c.attr("data-morphable-show")||a.showClass,m=c.attr("data-morphable-hide")||a.hideClass,h=c.attr("data-morphable-mode")||a.modeClass;for(c.addClass("w-morphable"),r="#"+c.attr("id")+".w-morphable",n=[],o=[],i=0;i<p.length;i++)if(m&&n.push(r+"."+h.split("${MODE}").join(p[i])+" ."+m.split("${MODE}").join(p[i])),f&&o.push(r+"."+h.split("${MODE}").join(p[i])+" ."+f.split("${MODE}").join(p[i])),f||m)for(j=0;j<p.length;j++)j!==i&&(f&&n.push(r+"."+h.split("${MODE}").join(p[i])+" ."+f.split("${MODE}").join(p[j])+":not(."+f.split("${MODE}").join(p[i])+")"),m&&o.push(r+"."+h.split("${MODE}").join(p[i])+" ."+m.split("${MODE}").join(p[j])+":not(."+m.split("${MODE}").join(p[i])+")"));n.length&&(u.hide_mode={selector:n.join(","),rules:["display: none !important"]}),o.length&&(u.show_mode={selector:o.join(","),rules:["display: block"]}),s=l(document,"all",d=u)},n.init=function(){t(e).hasClass("w-morphable")||n.create()},n.morph=function(n){if(n!=r){var i=t(e),l=i.attr("data-morphable-mode")||a.modeClass;r&&i.removeClass(l.split("${MODE}").join(r)),r=n,r&&i.addClass(l.split("${MODE}").join(r))}},n.mode=function(){return r},n.dispose=function(){t(e).removeClass("w-morphable"),d=null,s&&o(document,s),s=null}}),r("delayable",u.delayable=function k(e,a){var n=this;return n instanceof k?(n.init=function(){var a=t(e);a.hasClass("w-delayed")&&a.removeClass("w-delayed"),a.hasClass("w-undelayed")||a.addClass("w-undelayed"),a.children(".w-delayable-overlay").length||a.append('<div class="w-delayable-overlay"><div class="w-spinner w-spinner-dots"></div></div>')},n.enable=function(){var a=t(e);a.hasClass("w-delayed")||a.addClass("w-delayed").removeClass("w-undelayed")},void(n.disable=function(){var a=t(e);a.hasClass("w-delayed")&&a.addClass("w-undelayed").removeClass("w-delayed")})):new k(e,a)}),r("disabable",u.disabable=function C(e,a){var n=this;return n instanceof C?(n.init=function(){var a=t(e);a.hasClass("w-delayed")&&a.removeClass("w-delayed"),a.hasClass("w-undelayed")||a.addClass("w-undelayed"),a.children(".w-disabable-overlay").length||a.append('<div class="w-disabable-overlay"></div>')},n.enable=function(){var a=t(e);a.hasClass("w-disabled")||a.addClass("w-disabled").removeClass("w-undisabled")},void(n.disable=function(){var a=t(e);a.hasClass("w-disabled")&&a.addClass("w-undisabled").removeClass("w-disabled")})):new C(e,a)}),r("sortable",u.sortable=function D(e,a){var n=this;return n instanceof D?(n.instance=null,n.init=function(){if("function"==typeof Sortable){var i=t(e);n.instance=Sortable.create(e,{sort:!0,disabled:!1,delay:parseInt(i.attr("data-sortable-delay")||a.delay||0,10),animation:parseInt(i.attr("data-sortable-animation")||a.animation||400,10),draggable:i.attr("data-sortable-item")||a.draggable||a.item||".w-sortable-item",handle:i.attr("data-sortable-handle")||a.handle||".w-sortable-handle"})}},void(n.dispose=function(){n.instance=null})):new D(e,a)}),r("uploadable",u.uploadable=function O(a,n){var i=this,l=120;return i instanceof O?(i.dispose=function(){var e=t(a);e.off(".uploadable"),e=null},void(i.init=function(){var n=t(a);n.on("click.uploadable",".w-upload-thumbnail",function(){var t=n.find("._w-data"),a=n[0].imdata||(t.val()?h(t.val()):null);return a&&(n[0].imdata||(n[0].imdata=a),e.open(a.original?a.original:a.image,"preview_"+n.attr("id"),"scrollbars=yes,resizable=yes,width="+a.width+",height="+a.height).focus()),!1}).on("click.uploadable",".w-upload-delete",function(){return n[0].imdata=null,n.find("img").attr("src",""),n.find("._w-data").val("").trigger("change"),!1}).on("change.uploadable","input._w-uploader[type=file]",function(e){var a,i=(t(this),e.target.files[0]||null);return i&&i.type.match("image")?(a=new FileReader,a.addEventListener("load",function(e){var t=e.target.result,a=new Image;a.addEventListener("load",function(){setTimeout(function(){var e,o=a.width,r=a.height,s=l,d=Math.round(l*r/o),c=document.createElement("canvas"),u=c.getContext("2d");c.width=s,c.height=d,u.drawImage(a,0,0,o,r,0,0,s,d),e=c.toDataURL("image/png"),n[0].imdata={name:i.name,width:o,height:r,image:t,thumb:e},n.find("img").attr("src",e),n.find("._w-data").val(g(n[0].imdata)).trigger("change")},10)}),a.src=t}),void a.readAsDataURL(i)):!1})})):new O(a,n)}),r("datepicker",u.datepicker=function M(e,a){var n=this;return n instanceof M?(n.instance=null,n.init=function(){if("function"==typeof Pikaday){var i=t(e),l=i.attr("data-datepicker-format")||a.format||"Y-m-d";n.instance=new Pikaday({field:e,encoder:s(l),decoder:d(l)})}},void(n.dispose=function(){n.instance=null})):new M(e,a)}),r("colorpicker",u.colorpicker=function _(e,a){var n=this;return n instanceof _?(n.instance=null,n.init=function(){if("function"==typeof t.ColorPicker||"function"==typeof ColorPicker){var i=t(e),l="function"==typeof t.ColorPicker?t.ColorPicker:ColorPicker;n.instance=new l(e,{changeEvent:i.attr("data-colorpicker-change")||a.changeEvent||"change",format:i.attr("data-colorpicker-format")||a.format||"rgba",color:i.attr("data-colorpicker-color")||a.color,opacity:i.attr("data-colorpicker-opacity")||a.opacity})}},n.value=n.color=function(e,t){return n.instance?arguments.length?void n.instance.setColor(e,t):n.instance.getColor():void 0},void(n.dispose=function(){n.instance&&n.instance.dispose(),n.instance=null})):new _(e,a)}),r("gmap3",u.gmap3=function E(e,a){function n(){i&&google.maps.event.addListenerOnce(i,"idle",function(){google.maps.event.trigger(i,"resize"),i.setCenter(new google.maps.LatLng(l,o))})}var i,l,o,r,s=this;return s instanceof E?(i=null,a=t.extend({type:"ROADMAP",markers:null,center:null,kml:null,responsive:!1},a||{}),s.dispose=function(){r&&t(e.parentNode||document.body).off("resize",n),i=null},s.init=function(){var s=t(e),d=s.attr("data-map-center")?s.attr("data-map-center").split(","):a.center||[0,0],u=parseInt(s.attr("data-map-zoom")||a.zoom||6,10),p=s.attr("data-map-type")||a.type||"ROADMAP";l=parseFloat(d[0]||0,10),o=parseFloat(d[1]||0,10),i=new google.maps.Map(e,{zoom:u,center:new google.maps.LatLng(l,o),mapTypeId:google.maps.MapTypeId[p]}),s.children(".marker,.map-marker").each(function(){var e=t(this),a=e.attr("data-marker-position")?e.attr("data-marker-position").split(","):[0,0],n={lat:parseFloat(a[0]||0,10),lng:parseFloat(a[1]||0,10),title:e.attr("title"),info:e.html(),clickable:!!e.attr("data-marker-clickable"),draggable:!!e.attr("data-marker-draggable"),visible:!!e.attr("data-marker-visible")};c(i,n.lat,n.lng,n.title||"",n.info,n)}),s.empty(),s.attr("data-map-markers")&&t(s.attr("data-map-markers")).each(function(){var e=t(this),a=e.attr("data-marker-position")?e.attr("data-marker-position").split(","):[0,0],n={lat:parseFloat(a[0]||0,10),lng:parseFloat(a[1]||0,10),title:e.attr("title"),info:e.html(),clickable:!!e.attr("data-marker-clickable"),draggable:!!e.attr("data-marker-draggable"),visible:!!e.attr("data-marker-visible")};c(i,n.lat,n.lng,n.title||"",n.info,n)});var f,m,h=a.markers,g=h?h.length:0;for(f=0;g>f;f++)m=h[f],c(i,m.lat,m.lng,m.title||"",m.info,m);if(null!=a.kml){var w=new google.maps.KmlLayer(a.kml);w.setMap(i)}r=!(!s.attr("data-map-responsive")&&!a.responsive),r&&t(e.parentNode||document.body).on("resize",n)},s.map=function(){return i},s.center=function(e){return arguments.length?void(i&&(l=parseFloat(e[0],10),o=parseFloat(e[1],10),i.setCenter(new google.maps.LatLng(l,o)))):[l,o]},s.add_marker=function(e){return i&&e?c(i,e.lat,e.lng,e.title||"",e.info||null,e):void 0},s.remove_marker=function(e){e&&e.setMap(null)},s.add_markers=function(e){if(i&&e){for(var t=0;t<e.length;t++){var a=e[t];e[t]=c(i,a.lat,a.lng,a.title||"",a.info,a)}return e}},void(s.remove_markers=function(e){if(e)for(var t=0;t<e.length;t++)e[t].setMap(null)})):new E(e,a)}),u.widgetize=function(e){var a=t(e);a.hasClass("w-selectable")&&a.htmlwidget("selectable"),a.hasClass("w-removable")&&a.htmlwidget("removable"),a.hasClass("w-morphable")&&a.htmlwidget("morphable"),a.hasClass("w-delayable")&&a.htmlwidget("delayable"),a.hasClass("w-disabable")&&a.htmlwidget("disabable"),a.hasClass("w-draggable")&&a.htmlwidget("draggable"),a.hasClass("w-resizable")&&a.htmlwidget("resizable"),a.hasClass("w-sortable")&&a.htmlwidget("sortable")},u.initialisable=function(a,n){n=n||e;var i=t(a),l=i.attr("w-init");("1"===l||"true"===l||"on"===l)&&(l="__htmlwidget_init__"),l&&"function"==typeof n[l]&&(i.removeAttr("w-init"),n[l](a))},u.tooltip=function(){var e=t(this),a="",n=e.hasClass("tooltipstered");n||(a=e.attr(e.attr("data-tooltip")?"data-tooltip":"title"),a.length?e.tooltipster({onlyOne:!0,autoClose:!0,content:a,position:e.hasClass("tooltip-bottom")?"bottom":e.hasClass("tooltip-right")?"right":e.hasClass("tooltip-left")?"left":"top"}):e.removeAttr("title")),(n||a.length)&&e.tooltipster("show")},t.fn.htmlwidget=function(e,a){return a=a||{},this.each(function(){var n,i=this;if(u.widget[p](e)&&"function"==typeof u.widget[e])return void u.widget[e](i,a);switch(n=t(i),e){case"delayable":case"disabable":case"morphable":case"selectable":case"removable":case"sortable":case"uploadable":case"upload":n["upload"===e?"uploadable":e](a);break;case"draggable":"function"==typeof t.fn.tinyDraggable&&n.tinyDraggable(a);break;case"resisable":case"resizable":break;case"timer":"function"==typeof t.fn.Timer&&n.Timer(a);break;case"date":case"datetime":case"datepicker":n.datepicker(a);break;case"color":case"colorselector":case"colorpicker":n.colorpicker(a);break;case"rangeslider":case"range":"function"==typeof t.fn.rangeslider&&n.rangeslider({polyfill:!1,orientation:n.attr("data-range-orientation")||a.orientation||"horizontal"});break;case"map":case"gmap":case"gmap3":n.gmap3(a);break;case"select":case"select2":"function"==typeof t.fn.select2&&(n.select2(a),n.prev(".select2-container").attr("title",n.attr("title")).attr("data-tooltip",n.attr("data-tooltip")));break;case"autocomplete":case"autosuggest":case"suggest":if("function"==typeof t.fn.autocomplete){var l=(n.parent(),n.attr("data-request-method")||a.method||"POST"),o=n.attr("data-key")||a.key||"key",r=n.attr("data-val")||a.val||"val";n.autocomplete({minLength:0,valueKey:o,titleKey:r,highlight:!0,showHint:!0,dropdownWidth:"100%",openOnFocus:!1,closeOnBlur:!0,appendMethod:"replace",source:[{type:"remote",url:n.attr("data-ajax")||a.ajax,ajax:{type:l,method:l,dataType:n.attr("data-response-type")||a.dataType||"json"}}]})}break;case"table":case"datatable":"function"==typeof t.fn.dataTable&&(n.dataTable(a),n.closest(".dataTables_wrapper").addClass("w-table-wrapper"));break;case"modal":"function"==typeof t.fn.modal&&n.modal(a);break;case"modelview":"undefined"!=typeof ModelView&&(ModelView.jquery&&ModelView.jquery(t),n.modelview(a));break;case"tag-editor":"function"==typeof t.fn.tagEditor&&n.tagEditor(a);break;case"wysiwyg-editor":"function"==typeof t.fn.trumbowyg&&(n.trumbowyg(a),n.closest(".trumbowyg-box").addClass("widget w-wysiwyg-editor-box"));break;case"syntax-editor":"function"==typeof CodeMirror&&CodeMirror.fromTextArea(n[0],a)}}),this},u.init=function(e,a,n){var i=t(e);!0===n&&(i.find("input[type=range].w-rangeslider").htmlwidget("range"),i.find(".w-upload").htmlwidget("upload"),i.find(".w-suggest").htmlwidget("suggest"),i.find(".w-timer").htmlwidget("timer"),i.find(".w-date").htmlwidget("datepicker"),i.find(".w-color,.w-colorselector").htmlwidget("colorpicker"),i.find(".w-map").htmlwidget("map"),i.find(".w-select2").htmlwidget("select2")),!1!==a&&(i.is("input[type=range]")?i.htmlwidget("range"):i.hasClass("w-upload")?i.htmlwidget("upload"):i.hasClass("w-suggest")?i.htmlwidget("suggest"):i.hasClass("w-timer")?i.htmlwidget("timer"):i.hasClass("w-date")?i.htmlwidget("datepicker"):i.hasClass("w-color")||i.hasClass("w-colorselector")?i.htmlwidget("colorpicker"):i.hasClass("w-map")?i.htmlwidget("map"):i.hasClass("w-select2")&&i.htmlwidget("select2"))},e.__htmlwidget_init__=function(e){u.init(e)},t(function(){"undefined"!=typeof SelectorListener&&SelectorListener.jquery(t);var e=t(document.body),a=function(){u.initialisable(this)},n=function(){u.widgetize(this)};"function"==typeof t.fn.onSelector&&e.onSelector("[w-init]::added",a).onSelector(".w-selectable::added,.w-removable::added,.w-morphable::added,.w-delayable::added,.w-disabable::added,.w-sortable::added",n),t("[w-init]").each(a),t(".w-selectable,.w-removable,.w-morphable,.w-delayable,.w-disabable,.w-sortable").each(n),"function"==typeof t.fn.tooltipster&&("function"==typeof t.fn.onSelector?e.onSelector("[data-tooltip]:hover,[title]:hover",u.tooltip):e.on("mouseover","[data-tooltip],[title]",u.tooltip))})}(window,jQuery);