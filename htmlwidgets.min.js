/**
*  HtmlWidget
*  html widgets used as (template) plugins and/or standalone, for PHP, Node/JS, Python
*
*  @dependencies: FontAwesome, SelectorListener, jQuery
*  @version: 0.8.2
*  https://github.com/foo123/HtmlWidget
*  https://github.com/foo123/components.css
*  https://github.com/foo123/jquery-ui-widgets
*  https://github.com/foo123/modelview-widgets
*  https://github.com/foo123/SelectorListener
*
**/
!function(e,t,a){"use strict";function n(e,t){if("object"==typeof t){var a,n,i,l,s,o=0;for(a in t)t[p](a)&&(n=t[a],i=n.selector,l=[].concat(n.rules).join("; "),s=o++,"insertRule"in e.sheet?(e.sheet.insertRule(i+"{"+l+"}",s),n.css=e.sheet.cssRules[s]):"addRule"in e.sheet&&(e.sheet.addRule(i,l,s),n.css=e.sheet.rules[s]))}return t}function l(e,t,a){var i=e.createElement("style");return i.setAttribute("media",t||"all"),i.setAttribute("type","text/css"),i.appendChild(e.createTextNode("")),e.head.appendChild(i),a&&n(i,a),i}function s(e,t){t&&e.head.removeChild(t)}function o(e,n,i){var l=i&&i[h]?i[h]:null;t.fn[e]=function(i){var s,o="string"==typeof i?i:!1,r=f.call(arguments,1),d=this;return o?this.each(function(){var n,i=t.data(this,e);return"widget"===o?(d=i,!1):"instance"===o?(d=i?i.instance||i:i,!1):i?"dispose"===o||"destroy"===o?("function"==typeof i.dispose?i.dispose():"function"==typeof i.destroy?i.destroy():l&&("function"==typeof l.dispose?l.dispose.call(i):"function"==typeof l.destroy&&l.destroy.call(i)),i=null,t.removeData(this,e),!1):(s=i[o]||l&&l[o],"function"!=typeof s?!1:(n=s.apply(i,r),n!==i&&a!==n?(d=n&&n.jquery?d.pushStack(n.get()):n,!1):void 0)):!1}):(i=i||{},this.each(function(){var a=t.data(this,e);a?(s=a.options||l&&l.options,"function"==typeof s&&s.call(a,i)):(t.data(this,e,a=new n(this,i)),s=a.init||l&&l.init,"function"==typeof s&&s.call(a))})),d}}function r(e,t){return"function"==typeof DateX?(t=t||DateX.defaultLocale,function(a){return DateX.format(a,e,t)}):function(e){return e.toDateString()}}function d(e,t){if("function"==typeof DateX){t=t||DateX.defaultLocale;var a=DateX.getParser(e,t);return function(e){return!!e&&a(e)}}return function(e){return new Date(Date.parse(e))}}function c(e,t,a,n,i,l){var s,o,r={map:e,title:n,position:new google.maps.LatLng(t,a)};return"undefined"!==l.clickable&&(r.clickable=!!l.clickable),"undefined"!==l.draggable&&(r.draggable=!!l.draggable),"undefined"!==l.crossOnDrag&&(r.crossOnDrag=!!l.crossOnDrag),"undefined"!==l.visible&&(r.visible=!!l.visible),"undefined"!==l.icon&&(r.icon=l.icon),"undefined"!==l.zIndex&&(r.zIndex=l.zIndex),"undefined"!==l.shape&&(r.shape=l.shape),s=new google.maps.Marker(r),i&&(o=new google.maps.InfoWindow({content:i}),google.maps.event.addListener(s,"click",function(){o.open(e,s)})),s}{var u={VERSION:"0.8.2",widget:{}},p="hasOwnProperty",h="prototype",f=Array[h].slice,m=JSON.parse,g=JSON.stringify;Object[h].toString}t.htmlwidget=u,u.make=o,u.stylable=function b(e,t,a,n,i){var o=this;if(!(o instanceof b))return new b(e,t,a,n,i);var r={id:{selector:a,rules:null}};o.id=t,o.selector=a,o.rules=[];for(var d in n)n[p](d)&&o.rules.push(d+":"+n[d]);r[t].rules=o.rules,o.sheet=l(e,i||"all",r),o.sheet.setAttribute("id",o.id),o.style=r[t].css,o.dispose=function(){o.id=null,o.selector=null,o.rules=null,o.style=null,o.sheet&&s(e,o.sheet),o.sheet=null}},o("selectable",u.selectable=function w(e,a){var n=this;return n instanceof w?(n.init=function(){var n=t(e),i=n.attr("data-selectable-handle")||a.handle||".w-selectable-handle",l=a.selector||a.item;n.hasClass("w-selectable")||n.addClass("w-selectable"),n.on("click.selectable",i,function(e){if(e.shiftKey){var a=t(this);l&&(a=a.closest(l)),a.hasClass("w-selected")?(a.removeClass("w-selected"),a.trigger("deselected")):(a.addClass("w-selected"),a.trigger("selected"))}})},n.clear=function(){t(e).find(".w-selected").removeClass("w-selected")},void(n.dispose=function(){t(e).off(".selectable")})):new w(e,a)}),o("removable",u.removable=function v(e,a){var n=this;return n instanceof v?(n.init=function(){var n=t(e),i=n.attr("data-removable-handle")||a.handle||".w-removable-handle",l=n.attr("data-removable-item")||a.selector||a.item,s=parseInt(n.attr("data-removable-animation")||a.animation||400,10);n.hasClass("w-removable")||n.addClass("w-removable"),n.on("click.removable",i,function(){var e=t(this);l&&(e=e.closest(l)),e.fadeOut(s,function(){e.trigger("removed"),e.remove()})})},void(n.dispose=function(){t(e).off(".removable")})):new v(e,a)}),o("morphable",u.morphable=function y(e,a){var n=this;if(!(n instanceof y))return new y(e,a);var o=null,r=null,d=null;n.create=function(){var n,s,o,c=t(e),u={},p=c.attr("data-morphable-modes")?c.attr("data-morphable-modes").split(","):[].concat(a.modes||[]),h=c.attr("data-morphable-show")||a.showClass,f=c.attr("data-morphable-hide")||a.hideClass,m=c.attr("data-morphable-mode")||a.modeClass;for(c.addClass("w-morphable"),o="#"+c.attr("id")+".w-morphable",n=[],s=[],i=0;i<p.length;i++)if(f&&n.push(o+"."+m.split("${MODE}").join(p[i])+" ."+f.split("${MODE}").join(p[i])),h&&s.push(o+"."+m.split("${MODE}").join(p[i])+" ."+h.split("${MODE}").join(p[i])),h||f)for(j=0;j<p.length;j++)j!==i&&(h&&n.push(o+"."+m.split("${MODE}").join(p[i])+" ."+h.split("${MODE}").join(p[j])+":not(."+h.split("${MODE}").join(p[i])+")"),f&&s.push(o+"."+m.split("${MODE}").join(p[i])+" ."+f.split("${MODE}").join(p[j])+":not(."+f.split("${MODE}").join(p[i])+")"));n.length&&(u.hide_mode={selector:n.join(","),rules:["display: none !important"]}),s.length&&(u.show_mode={selector:s.join(","),rules:["display: block"]}),r=l(document,"all",d=u)},n.init=function(){t(e).hasClass("w-morphable")||n.create()},n.morph=function(n){if(n!=o){var i=t(e),l=i.attr("data-morphable-mode")||a.modeClass;o&&i.removeClass(l.split("${MODE}").join(o)),o=n,o&&i.addClass(l.split("${MODE}").join(o))}},n.mode=function(){return o},n.dispose=function(){t(e).removeClass("w-morphable"),d=null,r&&s(document,r),r=null}}),o("delayable",u.delayable=function C(e,a){var n=this;return n instanceof C?(n.init=function(){var a=t(e);a.hasClass("w-delayed")&&a.removeClass("w-delayed"),a.hasClass("w-undelayed")||a.addClass("w-undelayed"),a.children(".w-delayable-overlay").length||a.append('<div class="w-delayable-overlay"><div class="w-spinner w-spinner-dots"></div></div>')},n.enable=function(){var a=t(e);a.hasClass("w-delayed")||a.addClass("w-delayed").removeClass("w-undelayed")},void(n.disable=function(){var a=t(e);a.hasClass("w-delayed")&&a.addClass("w-undelayed").removeClass("w-delayed")})):new C(e,a)}),o("disabable",u.disabable=function k(e,a){var n=this;return n instanceof k?(n.init=function(){var a=t(e);a.hasClass("w-delayed")&&a.removeClass("w-delayed"),a.hasClass("w-undelayed")||a.addClass("w-undelayed"),a.children(".w-disabable-overlay").length||a.append('<div class="w-disabable-overlay"></div>')},n.enable=function(){var a=t(e);a.hasClass("w-disabled")||a.addClass("w-disabled").removeClass("w-undisabled")},void(n.disable=function(){var a=t(e);a.hasClass("w-disabled")&&a.addClass("w-undisabled").removeClass("w-disabled")})):new k(e,a)}),o("sortable",u.sortable=function D(e,a){var n=this;return n instanceof D?(n.instance=null,n.init=function(){if("function"==typeof Sortable){var i=t(e);n.instance=Sortable.create(e,{sort:!0,disabled:!1,delay:parseInt(i.attr("data-sortable-delay")||a.delay||0,10),animation:parseInt(i.attr("data-sortable-animation")||a.animation||400,10),draggable:i.attr("data-sortable-item")||a.draggable||a.item||".w-sortable-item",handle:i.attr("data-sortable-handle")||a.handle||".w-sortable-handle"})}},void(n.dispose=function(){n.instance=null})):new D(e,a)}),o("uploadable",u.uploadable=function x(a,n){var i=this,l=120;return i instanceof x?(i.dispose=function(){var e=t(a);e.off(".uploadable"),e=null},void(i.init=function(){var n=t(a);n.on("click.uploadable",".w-upload-thumbnail",function(){var t=n.find("_w-data"),a=n[0].imdata||(t.val()?m(t.val()):null);return a&&(n[0].imdata||(n[0].imdata=a),e.open(a.original?a.original:a.image,"preview_"+n.attr("id"),"scrollbars=yes,resizable=yes,width="+a.width+",height="+a.height).focus()),!1}).on("click.uploadable",".w-upload-delete",function(){return n[0].imdata=null,n.find("img").attr("src",""),n.find("._w-data").val("").trigger("change"),!1}).on("change.uploadable","input._w-uploader[type=file]",function(e){var a,i=(t(this),e.target.files[0]||null);return i&&i.type.match("image")?(a=new FileReader,a.addEventListener("load",function(e){var t=e.target.result,a=new Image;a.addEventListener("load",function(){setTimeout(function(){var e,s=a.width,o=a.height,r=l,d=Math.round(l*o/s),c=document.createElement("canvas"),u=c.getContext("2d");c.width=r,c.height=d,u.drawImage(a,0,0,s,o,0,0,r,d),e=c.toDataURL("image/png"),n[0].imdata={name:i.name,width:s,height:o,image:t,thumb:e},n.find("img").attr("src",e),n.find("_w-data").val(g(n[0].imdata)).trigger("change")},10)}),a.src=t}),void a.readAsDataURL(i)):!1})})):new x(a,n)}),o("datepicker",u.datepicker=function L(e,a){var n=this;return n instanceof L?(n.instance=null,n.init=function(){if("function"==typeof Pikaday){var i=t(e),l=i.attr("data-datepicker-format")||a.format||"Y-m-d";n.instance=new Pikaday({field:e,encoder:r(l),decoder:d(l)})}},void(n.dispose=function(){n.instance=null})):new L(e,a)}),o("colorpicker",u.colorpicker=function O(e,a){var n=this;return n instanceof O?(n.instance=null,n.init=function(){if("function"==typeof t.ColorPicker||"function"==typeof ColorPicker){var i=t(e),l="function"==typeof t.ColorPicker?t.ColorPicker:ColorPicker;n.instance=new l(e,{changeEvent:i.attr("data-colorpicker-change")||a.changeEvent||"change",format:i.attr("data-colorpicker-format")||a.format||"rgba",color:i.attr("data-colorpicker-color")||a.color,opacity:i.attr("data-colorpicker-opacity")||a.opacity})}},n.value=n.color=function(e,t){return n.instance?arguments.length?void n.instance.setColor(e,t):n.instance.getColor():void 0},void(n.dispose=function(){n.instance&&n.instance.dispose(),n.instance=null})):new O(e,a)}),o("gmap3",u.gmap3=function M(e,a){function n(){i&&google.maps.event.addListenerOnce(i,"idle",function(){google.maps.event.trigger(i,"resize"),i.setCenter(new google.maps.LatLng(l,s))})}var i,l,s,o,r=this;return r instanceof M?(i=null,a=t.extend({type:"ROADMAP",markers:null,center:null,kml:null,responsive:!1},a||{}),r.dispose=function(){o&&t(e.parentNode||document.body).off("resize",n),i=null},r.init=function(){var r=t(e),d=r.attr("data-map-center")?r.attr("data-map-center").split(","):a.center||[0,0],u=parseInt(r.attr("data-map-zoom")||a.zoom||6,10),p=r.attr("data-map-type")||a.type||"ROADMAP";l=parseFloat(d[0]||0,10),s=parseFloat(d[1]||0,10),i=new google.maps.Map(e,{zoom:u,center:new google.maps.LatLng(l,s),mapTypeId:google.maps.MapTypeId[p]}),r.children(".marker,.map-marker").each(function(){var e=t(this),a=e.attr("data-marker-position")?e.attr("data-marker-position").split(","):[0,0],n={lat:parseFloat(a[0]||0,10),lng:parseFloat(a[1]||0,10),title:e.attr("title"),info:e.html(),clickable:!!e.attr("data-marker-clickable"),draggable:!!e.attr("data-marker-draggable"),visible:!!e.attr("data-marker-visible")};c(i,n.lat,n.lng,n.title||"",n.info,n)}),r.empty(),r.attr("data-map-markers")&&t(r.attr("data-map-markers")).each(function(){var e=t(this),a=e.attr("data-marker-position")?e.attr("data-marker-position").split(","):[0,0],n={lat:parseFloat(a[0]||0,10),lng:parseFloat(a[1]||0,10),title:e.attr("title"),info:e.html(),clickable:!!e.attr("data-marker-clickable"),draggable:!!e.attr("data-marker-draggable"),visible:!!e.attr("data-marker-visible")};c(i,n.lat,n.lng,n.title||"",n.info,n)});var h,f,m=a.markers,g=m?m.length:0;for(h=0;g>h;h++)f=m[h],c(i,f.lat,f.lng,f.title||"",f.info,f);if(null!=a.kml){var b=new google.maps.KmlLayer(a.kml);b.setMap(i)}o=!(!r.attr("data-map-responsive")&&!a.responsive),o&&t(e.parentNode||document.body).on("resize",n)},r.map=function(){return i},r.center=function(e){return arguments.length?void(i&&(l=parseFloat(e[0],10),s=parseFloat(e[1],10),i.setCenter(new google.maps.LatLng(l,s)))):[l,s]},r.add_marker=function(e){return i&&e?c(i,e.lat,e.lng,e.title||"",e.info||null,e):void 0},r.remove_marker=function(e){e&&e.setMap(null)},r.add_markers=function(e){if(i&&e){for(var t=0;t<e.length;t++){var a=e[t];e[t]=c(i,a.lat,a.lng,a.title||"",a.info,a)}return e}},void(r.remove_markers=function(e){if(e)for(var t=0;t<e.length;t++)e[t].setMap(null)})):new M(e,a)}),o("suggest",u.suggest=function(){function a(e,i){n++,this.element=t(e),this.options=t.extend({},a.defaults,i),this.cache={},this.id="remotelist-"+n,this.options.param||(this.options.param=this.element.prop("name")||"q"),this._createDatalist(),this._bindEvents(this)}var n=0;return a.defaults={minLength:2,maxLength:-1,source:"",param:"",select:t.noop,renderItem:null},a.createOption=function(e){var a=t(document.createElement("option"));return e&&"string"!=typeof e||(e={value:e}),a.prop("value",e.value),e.label&&a.prop("label",e.label),a.data("optionData",e),a[0]},a[h]={selectedData:function(){var e=this.selectedOption();return e&&t(e).data("optionData")},selectedOption:function(){var e=null,a=this.val();return a&&(e=t('[value="'+a+'"]',this.element.prop("list"))[0]||null),e},search:function(e){var a,n,i,l,s=this,o=this.options,r=e;o.maxLength>-1&&(r=r.substr(o,o.maxLength)),this.doAjax=!1,this.cache[r]?this.setList(this.cache[r],r):this.currentAjax?this.doAjax=e:(this.element.addClass("list-search"),a={},a[o.param]=e,this.currentAjax=!0,l=function(){l.xhr&&l.xhr.abort&&l.xhr.abort(),s.currentAjax=!1,clearTimeout(l.timer),s.doAjax?s.search(s.doAjax):s.element.removeClass("list-search")},n=t.isFunction(o.source)?o.source:function(e,a,n,i,l){return t.ajax({dataType:"json",url:l,data:i,context:this,error:n,success:a})},i=function(e){s.setList(e,r),l()},l.timer=setTimeout(l,999),l.xhr=n(e,i,l,a,o.source))},setList:function(e,n){e||(e=[]),this.currentOptions!=e&&this.currentVal!==n&&(this.currentOptions=e,this.currentVal=n,this.cache[n]=e,e=t.map(e,a.createOption),this.datalistSelect.html(e),t.fn.updatePolyfill&&this.datalistSelect.updatePolyfill())},_createDatalist:function(){this.datalistSelect=this.element.prop("list"),this.datalistSelect||(this.datalistSelect=t('<datalist id="'+this.id+'"><select /></datalist>'),this.element.attr("list",this.id),this.element.after(this.datalistSelect)),this.datalistSelect=t("select",this.datalistSelect)},val:function(){return e.webshims&&webshims.getDataListVal?webshims.getDataListVal(this.element[0]):this.element.prop("value")},widget:function(){return this},_bindEvents:function(e){var a,n,i,l=e.options,s=function(){var n;return function(s){var o=e.val();if(o!==n&&(n=o,"change"==s||!i||i.toLowerCase()!=o.charAt(o.length-1).toLowerCase()))return e.selectedOption()?(clearTimeout(a),l.select&&l.select.call(e.element[0],t.Event("listselect")),e.element.trigger("listselect"),!0):void 0}}();e.element.on({"input focus":function(){var t=function(){var t=e.val();t.length>=l.minLength&&e.search(t)};return function(){clearTimeout(a),a=setTimeout(t,99)}}(),"input change":function(t){clearTimeout(n),"change"==t.type?(clearTimeout(a),e.element.is(":focus")&&s("change")):n=setTimeout(s,9)},keypress:function(){var e=function(){i=""};return function(t){i=String.fromCharCode(t.charCode),setTimeout(e,20)}}(),getoptioncontent:function(e,a){return l.renderItem?l.renderItem('<span class="option-value">'+a.item.value+"</span>",a.item.label&&'<span class="option-label">'+a.item.label+"</span>",t.data(a.item.elem,"optionData")):void 0}})}},a}()),u.widgetize=function(e){var a=t(e);a.hasClass("w-selectable")&&a.htmlwidget("selectable"),a.hasClass("w-removable")&&a.htmlwidget("removable"),a.hasClass("w-morphable")&&a.htmlwidget("morphable"),a.hasClass("w-delayable")&&a.htmlwidget("delayable"),a.hasClass("w-disabable")&&a.htmlwidget("disabable"),a.hasClass("w-draggable")&&a.htmlwidget("draggable"),a.hasClass("w-resizable")&&a.htmlwidget("resizable"),a.hasClass("w-sortable")&&a.htmlwidget("sortable")},u.initialisable=function(a,n){n=n||e;var i=t(a),l=i.attr("w-init");("1"===l||"true"===l||"on"===l)&&(l="__htmlwidget_init__"),l&&"function"==typeof n[l]&&(i.removeAttr("w-init"),n[l](a))},u.tooltip=function(){var e=t(this),a="",n=e.hasClass("tooltipstered");n||(a=e.attr(e.attr("data-tooltip")?"data-tooltip":"title"),a.length?e.tooltipster({onlyOne:!0,autoClose:!0,content:a,position:e.hasClass("tooltip-bottom")?"bottom":e.hasClass("tooltip-right")?"right":e.hasClass("tooltip-left")?"left":"top"}):e.removeAttr("title")),(n||a.length)&&e.tooltipster("show")},t.fn.htmlwidget=function(e,a){return a=a||{},this.each(function(){var n,i=this;if(u.widget[p](e)&&"function"==typeof u.widget[e])return void u.widget[e](i,a);switch(n=t(i),e){case"delayable":case"disabable":case"morphable":case"selectable":case"removable":case"sortable":case"uploadable":case"upload":n["upload"===e?"uploadable":e](a);break;case"draggable":"function"==typeof t.fn.tinyDraggable&&n.tinyDraggable(a);break;case"resisable":case"resizable":break;case"timer":"function"==typeof t.fn.Timer&&n.Timer(a);break;case"date":case"datetime":case"datepicker":n.datepicker(a);break;case"color":case"colorselector":case"colorpicker":n.colorpicker(a);break;case"rangeslider":case"range":"function"==typeof t.fn.rangeslider&&n.rangeslider({polyfill:!1,orientation:n.attr("data-range-orientation")||a.orientation||"horizontal"});break;case"map":case"gmap":case"gmap3":n.gmap3(a);break;case"select":case"select2":"function"==typeof t.fn.select2&&n.select2(a);break;case"autocomplete":case"autosuggest":case"suggest":var l=n.parent(),s=n.attr("data-ajax"),o=n.attr("data-request-method")||"POST",r=n.attr("data-response-type")||"json";n.suggest({minLength:2,maxLength:-1,source:function(e,a){l.addClass("ajax"),t.ajax({url:s,type:o,dataType:r,data:{suggest:e},success:function(e){l.removeClass("ajax"),a(e)}})},select:a.select||function(){}});break;case"table":case"datatable":"function"==typeof t.fn.dataTable&&(n.dataTable(a),n.closest(".dataTables_wrapper").addClass("w-table-wrapper"));break;case"modal":"function"==typeof t.fn.modal&&n.modal(a);break;case"modelview":"undefined"!=typeof ModelView&&(ModelView.jquery&&ModelView.jquery(t),n.modelview(a));break;case"tag-editor":"function"==typeof t.fn.tagEditor&&n.tagEditor(a);break;case"wysiwyg-editor":"function"==typeof t.fn.trumbowyg&&(n.trumbowyg(a),n.closest(".trumbowyg-box").addClass("widget w-wysiwyg-editor-box"));break;case"syntax-editor":"function"==typeof CodeMirror&&CodeMirror.fromTextArea(n[0],a)}}),this},u.init=function(e,a,n){var i=t(e);!0===n&&(i.find("input[type=range].w-rangeslider").htmlwidget("range"),i.find(".w-upload").htmlwidget("upload"),i.find(".w-suggest").htmlwidget("suggest"),i.find(".w-timer").htmlwidget("timer"),i.find(".w-date").htmlwidget("datepicker"),i.find(".w-color,.w-colorselector").htmlwidget("colorpicker"),i.find(".w-map").htmlwidget("map"),i.find(".w-select2").htmlwidget("select2")),!1!==a&&(i.is("input[type=range]")?i.htmlwidget("range"):i.hasClass("w-upload")?i.htmlwidget("upload"):i.hasClass("w-suggest")?i.htmlwidget("suggest"):i.hasClass("w-timer")?i.htmlwidget("timer"):i.hasClass("w-date")?i.htmlwidget("datepicker"):i.hasClass("w-color")||i.hasClass("w-colorselector")?i.htmlwidget("colorpicker"):i.hasClass("w-map")?i.htmlwidget("map"):i.hasClass("w-select2")&&i.htmlwidget("select2"))},e.__htmlwidget_init__=function(e){u.init(e)},t(function(){"undefined"!=typeof SelectorListener&&SelectorListener.jquery(t);var e=t(document.body),a=function(){u.initialisable(this)},n=function(){u.widgetize(this)};"function"==typeof t.fn.onSelector&&e.onSelector("[w-init]::added",a).onSelector(".w-selectable::added,.w-removable::added,.w-morphable::added,.w-delayable::added,.w-disabable::added,.w-sortable::added",n),t("[w-init]").each(a),t(".w-selectable,.w-removable,.w-morphable,.w-delayable,.w-disabable,.w-sortable").each(n),"function"==typeof t.fn.tooltipster&&("function"==typeof t.fn.onSelector?e.onSelector("[data-tooltip]:hover,[title]:hover",u.tooltip):e.on("mouseover","[data-tooltip],[title]",u.tooltip))})}(window,jQuery);