/**
*
*   ModelView.js
*   @version: 0.66
*   @built on 2015-09-07 14:51:49
*
*   A simple/extendable MV* (MVVM) framework
*   optionaly integrates into both jQuery as MVVM plugin and jQueryUI as MVC widget
*   https://github.com/foo123/modelview.js
*
**/!function(e,n,t){"use strict";var r,i="object"==typeof module&&module.exports,o="function"==typeof define&&define.amd;i?module.exports=(module.$deps=module.$deps||{})[n]=module.$deps[n]||t.call(e,{NODE:module})||1:o&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(n)?define(n,["require","exports","module"],function(n,r,i){return t.call(e,{AMD:i})}):n in e||(e[n]=r=t.call(e,{})||1)&&o&&define(n,[],function(){return r})}(this,"ModelView",function(e){"use strict";function n(e,n){var t=[e||"",Gn];return n&&(t=t.concat(n)),t.join(".")}function t(e){return-1<Jn.indexOf(e)}function r(e,n){return e===n}function o(e,n){return e.toLowerCase()===n.tagName.toLowerCase()}function u(e,n){return e===n.id}function l(e,n){return n[On](e)}function a(e){var n=this;return n instanceof a?(e&&n.element(e),void(n.$handle=a.Handler.bind(n))):new a(e)}var s=void 0,c=function(e,n){return e.bind(n)},f="prototype",d=Array,h=d[f],p=RegExp,g=Object,v=g[f],m=g.create,$=g.keys,y=Function,b=(y[f],String),_=b[f],w=v.toString,k=h.slice,E=function(e){return b(e)},S=function(e,n){return new y(e,n)},M=function(e,n){return e instanceof n},D=1/0,x=(Math.random,/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g),A=function(e){return e.replace(x,"\\$&")},C=function(e,n,t){return e[n]=s,t||delete e[n],e},O=4,j=5,I=6,L=8,N=16,P=17,z=32,H=64,V=128,R=256,F=512,Y=1024,U=2048,B=4096,W=N|z,G=H|z,Z={"[object Number]":O,"[object String]":N,"[object Array]":z,"[object RegExp]":R,"[object Date]":F,"[object Function]":V,"[object Object]":H},X=function(e){if(null===e)return Y;if(!0===e||!1===e||e instanceof Boolean)return L;if(s===e)return U;var n=Z[w.call(e)]||B;return O===n||e instanceof Number?isNaN(e)?I:isFinite(e)?O:j:N===n||e instanceof String?1===e.length?P:N:z===n||e instanceof Array?z:R===n||e instanceof RegExp?R:F===n||e instanceof Date?F:V===n||e instanceof Function?V:H===n?H:B},q=function(e,n){return!!(n&X(e))},J=function(e){return!isNaN(parseFloat(e,10))&&isFinite(e)},K=function(e){return J(e)&&(e=+e,0===e%1&&e>=0)?!0:!1},Q=function(e,n){var t,r=e.length,i=15&r,o=1&i,u=new Array(r);for(o&&(u[0]=n(e[0])),t=o;i>t;t+=2)u[t]=n(e[t]),u[t+1]=n(e[t+1]);for(t=i;r>t;t+=16)u[t]=n(e[t]),u[t+1]=n(e[t+1]),u[t+2]=n(e[t+2]),u[t+3]=n(e[t+3]),u[t+4]=n(e[t+4]),u[t+5]=n(e[t+5]),u[t+6]=n(e[t+6]),u[t+7]=n(e[t+7]),u[t+8]=n(e[t+8]),u[t+9]=n(e[t+9]),u[t+10]=n(e[t+10]),u[t+11]=n(e[t+11]),u[t+12]=n(e[t+12]),u[t+13]=n(e[t+13]),u[t+14]=n(e[t+14]),u[t+15]=n(e[t+15]);return u},en=function(e,n){var t,r=e.length,i=15&r,o=1&i,u=[];for(o&&n(e[0])&&u.push(e[0]),t=o;i>t;t+=2)n(e[t])&&u.push(e[t]),n(e[t+1])&&u.push(e[t+1]);for(t=i;r>t;t+=16)n(e[t])&&u.push(e[t]),n(e[t+1])&&u.push(e[t+1]),n(e[t+2])&&u.push(e[t+2]),n(e[t+3])&&u.push(e[t+3]),n(e[t+4])&&u.push(e[t+4]),n(e[t+5])&&u.push(e[t+5]),n(e[t+6])&&u.push(e[t+6]),n(e[t+7])&&u.push(e[t+7]),n(e[t+8])&&u.push(e[t+8]),n(e[t+9])&&u.push(e[t+9]),n(e[t+10])&&u.push(e[t+10]),n(e[t+11])&&u.push(e[t+11]),n(e[t+12])&&u.push(e[t+12]),n(e[t+13])&&u.push(e[t+13]),n(e[t+14])&&u.push(e[t+14]),n(e[t+15])&&u.push(e[t+15]);return u},nn=function(e,n){var t,r=e.length,i=15&r,o=1&i;for(o&&n(e[0]),t=o;i>t;t+=2)n(e[t]),n(e[t+1]);for(t=i;r>t;t+=16)n(e[t]),n(e[t+1]),n(e[t+2]),n(e[t+3]),n(e[t+4]),n(e[t+5]),n(e[t+6]),n(e[t+7]),n(e[t+8]),n(e[t+9]),n(e[t+10]),n(e[t+11]),n(e[t+12]),n(e[t+13]),n(e[t+14]),n(e[t+15]);return e},tn=function(){var e,n,t,r,i,o,u,l=arguments;for(n=l[0]||{},e=l.length,o=1;e>o;o++)if(t=l[o],H===X(t))for(i in t)r=t[i],u=X(r),n[i]=O&u?0+r:W&u?r.slice(0):r;return n},rn="hasOwnProperty",on="getAttribute",un="setAttribute",ln="checked",an="disabled",sn="selected",cn="name",fn="tagName",dn="type",hn="value",pn="options",gn="selectedIndex",vn="parentNode",mn="style",$n="innerHTML",yn="innerText",bn="textContent",_n=JSON.parse,wn=(JSON.stringify,_.trim?function(e){return e.trim()}:function(e){return e.replace(/^\s+|\s+$/g,"")}),kn=_.startsWith?function(e,n,t){return e.startsWith(n,t||0)}:function(e,n,t){return n===e.slice(t||0,n.length)},Tn=Date.now?Date.now:function(){return(new Date).getTime()},En=function(){var e,n,t,r,i,o,u,l,a,s,c,f,d,h,p,g=arguments,v=g.length,m="|^",$="|v";if(v){for(u=1,p=[],o=[],f=[],c=[],e=v-1;e>=0;e--)s=g[e],c.unshift("f"+e),s.push?(f.unshift(s[1]),s=s[0]):f.unshift(null),h=s.slice(-2),$===h?(d=!0,s=s.slice(0,-2)):m===h?(d=!1,s=s.slice(0,-2)):d=!1,s=s.length?'["'+s.split(".").join('"]["')+'"]':"",n="a"+s,t="b"+s,f[0]&&(n=c[0]+"("+n+")",t=c[0]+"("+t+")"),r="a_"+e,i="b_"+e,o.unshift(""+r+"="+n+","+i+"="+t),l=d?""+u:"-"+u,a=d?"-"+u:""+u,p.unshift("("+r+" < "+i+" ? "+l+" : ("+r+" > "+i+" ? "+a+" : 0))"),u<<=1;return S(c.join(","),["return function(a,b) {","  var "+o.join(",")+";","  return "+p.join("+")+";","};"].join("\n")).apply(null,f)}return n="a",t="b",l="-1",a="1",p=""+n+" < "+t+" ? "+l+" : ("+n+" > "+t+" ? "+a+" : 0)",S("a,b","return "+p+";")},Sn=function(e){for(var n=0;e=e.previousSibling;)n++;return n},Mn=function(e,n){var t=e;if(n)for(;t[vn]&&t[vn]!==n;)t=t[vn];return Sn(t)},Dn=function(e,n,t){var r,i=e.childNodes,o=i.length,u=null,l=0,a=0;for(t=t||1;o>l&&(r=i[l++],n!==r.nodeType||(u=r,++a!==t)););return u},xn=function(e,n){return k.call((n||document).getElementsByTagName(e),0)},An=function(e,n,t){return!0===t?[(n||document).querySelector(e)]:k.call((n||document).querySelectorAll(e),0)},Cn=function(e,n){return kn(n,"$this::")?An(n.slice(7),e):An(n,null)},On=(function(){var e=document.createElement("div");return"outerHTML"in e?function(e){return e.outerHTML}:function(n){var t=e.cloneNode();return t.appendChild(n.cloneNode(!0)),t.innerHTML}}(),function(e){return!e||e.matches?"matches":e.matchesSelector?"matchesSelector":e.webkitMatchesSelector?"webkitMatchesSelector":e.mozMatchesSelector?"mozMatchesSelector":e.msMatchesSelector?"msMatchesSelector":e.oMatchesSelector?"oMatchesSelector":void 0}(this.Element?this.Element[f]:null)),jn="undefined"!=typeof window&&window.getComputedStyle?function(e){return window.getComputedStyle(e,null)}:function(e){return e.currentStyle},In=function(e){e._displayCached||(e._displayCached=jn(e).display||"block"),e[mn].display="none"!==e._displayCached?e._displayCached:"block",e._displayCached=s},Ln=function(e){e._displayCached||(e._displayCached=jn(e).display||"block"),e[mn].display="none"},Nn=function(e){var n=e.attributes[hn];return!n||n.specified?e[hn]:e.text},Pn=function(e){for(var n,t,r=e[pn],i=e[gn],o="select-one"===e[dn]||0>i,u=o?null:[],l=o?i+1:r.length,a=0>i?l:o?i:0;l>a;a++)if(t=r[a],!(!t[sn]&&a!==i||t[an]||t[vn][an]&&"OPTGROUP"===t[vn][fn])){if(n=Nn(t),o)return n;u.push(n)}return u},zn=function(e,n){var t,r,i=Q([].concat(n),E),o=e[pn];for(r=0;r<o.length;r++)t=o[r],t[sn]=-1<i.indexOf(Nn(t));i.length||(e[gn]=-1)},Hn=function(e){if(e)switch(e[fn]){case"TEXTAREA":case"INPUT":return e[hn];case"SELECT":return Pn(e);default:return bn in e?e[bn]:e[yn]}},Vn=function(e,n){if(e)switch(e[fn]){case"TEXTAREA":case"INPUT":e[hn]=b(n);break;case"SELECT":zn(e,n);break;default:bn in e?e[bn]=b(n):e[yn]=b(n)}},Rn=function(e){return e.length>0},Fn=/\s+/g,Yn=function(e){var n=e.split("."),t=n[0];return n=en(n.slice(1),Rn),[t,n.sort()]},Un=function(e){return e.length?new p("(^|\\.)"+e.join("\\.(?:.*\\.|)")+"(\\.|$)"):!1},Bn=function(e,n){var t=this;t.v=e||null,t.n=n||{}},Wn="*",Gn="modelview",Zn=0,Xn=function(e){return[e||"UUID",++Zn,Tn()].join("_")};this.Element&&!this.Element[f].addEventListener&&!function(){function e(e,n){Window[f][e]=HTMLDocument[f][e]=Element[f][e]=n}e("addEventListener",function(e,n){var t=this,r=t.addEventListener.listeners=t.addEventListener.listeners||{},i=r[e]=r[e]||[];i.length||(i.event=function(e){var n=t.document&&t.document.documentElement||t.documentElement||{scrollLeft:0,scrollTop:0};e.currentTarget=t,e.pageX=e.clientX+n.scrollLeft,e.pageY=e.clientY+n.scrollTop,e.preventDefault=function(){e.returnValue=!1},e.relatedTarget=e.fromElement||null,e.stopImmediatePropagation=function(){l=!1,e.cancelBubble=!0},e.stopPropagation=function(){e.cancelBubble=!0},e.target=e.srcElement||t,e.timeStamp=+new Date;for(var r,o=0,u=[].concat(i),l=!0;l&&(r=u[o]);++o)for(var a,s=0;a=i[s];++s)if(a==r){a.call(t,e);break}},t.attachEvent?t.attachEvent("on"+e,i.event):t["on"+e]=i.event),i.push(n)}),e("removeEventListener",function(e,n){for(var t,r=this,i=r.addEventListener.listeners=r.addEventListener.listeners||{},o=i[e]=i[e]||[],u=o.length-1;t=o[u];--u)if(t==n){o.splice(u,1);break}!o.length&&o.event&&(r.detachEvent?r.detachEvent("on"+e,o.event):r["on"+e]=!1)}),e("dispatchEvent",function(e){var n=this,t=e.type,r=n.addEventListener.listeners=n.addEventListener.listeners||{},i=r[t]=r[t]||[];try{return n.fireEvent("on"+t,e)}catch(o){return void(i.event&&i.event(e))}})}();var qn="DOMEVENT_STOPPED",Jn=["blur","error","focus","focusin","focusout","load","resize","scroll"];a.Handler=function(e){if(!e[qn]){var n,t,r,i,o,u,l,a=this,s=e.type,c=e.target,f=[];switch(c&&3===c.nodeType&&(c=c.parentNode),i=a.$element,r=i.$listeners,o=e.eventPhase||(e.target!==e.currentTarget?3:2)){case 1:f=r[1][s];break;case 2:r[0]&&r[0][s]&&(f=f.concat(r[0][s])),r[1]&&r[1][s]&&(f=f.concat(r[1][s]));break;case 3:f=r[0][s]}if(f)for(t=f.length;t&&c;){for(n=0;t>n;n++){if(!f)return;if(u=f[n],!u)break;if(u.matcher(u.matcherParam,c)&&(l=u.handler.call(c,e,c)),!1===l||!1===e.returnValue)return e[qn]=!0,void e.preventDefault()}if(i===c)break;t=f.length,c=c.parentElement}}},a[f]={constructor:a,$element:null,$handle:null,dispose:function(){var e=this;return e.off().element(),e.$element=null,e.$handle=null,e},element:function(e){var n,t,r,i=this,o=i.$element;if(o){for(n=o.$listeners,t=$(n[1]),r=0;r<t.length;r++)o.removeEventListener(t[r],i.$handle,!0);for(t=$(n[0]),r=0;r<t.length;r++)o.removeEventListener(t[r],i.$handle,!1);o.$listeners=s}return e&&e.addEventListener?(i.$element=e,e.$listeners=e.$listeners||[{},{}],i):(i.$element=null,i)},on:function(e,n,i,a){var c,f,d,h,p,g,v,m,$=this;if(c=$.$element,!c)return $;if(!e)throw new TypeError("Invalid event type: "+e);if(v=e.split(Fn).map(Yn),!v.length)return $;if("function"==typeof n&&(a=i,i=n,n=null),"function"!=typeof i)throw new TypeError("Handler must be a type of Function");for(h=0,p=v.length;p>h;h++)m=s===a?t(v[h][0]):!!a,f=c.$listeners[m?1:0],f[v[h][0]]||(f[v[h][0]]=[],c.addEventListener(v[h][0],$.$handle,m)),n?/^[a-z]+$/i.test(n)?(g=n,d=o):/^#[a-z0-9\-_]+$/i.test(n)?(g=n.slice(1),d=u):(g=n,d=l):(g=c,d=r),f[v[h][0]].push({selector:n,handler:i,matcher:d,matcherParam:g,namespace:v[h][1].join(".")});return $},off:function(e,n,t,r){var i,o,u,l,a,c,f,d,h,p,g=this,v=g.$element,m=!1;if(!v)return g;if("function"==typeof n&&(r=t,t=n,n=null),m=s===r?[0,1]:r?[1]:[0],p=e?e.split(/\s+/g).map(Yn):[],p.length){for(c=0;c<m.length;c++)for(u=v.$listeners[m[c]],a=0;a<p.length;a++)if(d=p[a][1],f=p[a][0],h=Un(d),f.length){if(l=u[f],!l||!l.length)continue;for(i=l.length-1;i>=0;i--)o=l[i],n&&n!==o.selector||t&&t!==o.handler||h&&!h.test(o.namespace)||l.splice(i,1);l.length||(delete u[f],v.removeEventListener(f,g.$handle,!!m[c]))}else for(f in u)if(l=u[f],l&&l.length){for(i=l.length-1;i>=0;i--)o=l[i],n&&n!==o.selector||t&&t!==o.handler||h&&!h.test(o.namespace)||l.splice(i,1);l.length||(delete u[f],v.removeEventListener(f,g.$handle,!!m[c]))}}else for(c=0;c<m.length;c++){u=v.$listeners[m[c]];for(f in u)if(l=u[f],l&&l.length){for(i=l.length-1;i>=0;i--)o=l[i],n&&n!==o.selector||t&&t!==o.handler||l.splice(i,1);l.length||(delete u[f],v.removeEventListener(f,g.$handle,!!m[c]))}}return g}};var Kn=2,Qn=function(e,n,t){var r=this;return r instanceof Qn?(r.type=e,r.target=n,r.currentTarget=n,r.timeStamp=Tn(),r.eventPhase=Kn,void(r.namespace=t||null)):new Qn(e,n,t)};Qn[f]={constructor:Qn,type:null,target:null,currentTarget:null,timeStamp:null,eventPhase:Kn,bubbles:!1,cancelable:!1,namespace:null,stopPropagation:function(){this.bubbles=!1},preventDefault:function(){}};var et={$PB:null,namespace:null,initPubSub:function(){var e=this;return e.$PB={},e},disposePubSub:function(){var e=this;return e.$PB=null,e},trigger:function(e,n){var t,r,i,o,u,l,a,s=this,c=s.$PB;if(l=Yn(e),e=l[0],a="evt_"+e,c[rn](a)&&(t=c[a])&&(u=t.length)){for(r=t.slice(0),l=l[1].join("."),e=new Qn(e,s,l),o=0;u>o&&(i=r[o],i[2]&&i[3]||(i[3]=1,!1!==i[0](e,n)));o++);if(c[rn](a)&&(t=c[a])&&(u=t.length))if(t.oneOffs>0)for(o=u-1;o>=0;o--)r=t[o],r[2]&&r[3]&&(t.splice(o,1),t.oneOffs=t.oneOffs>0?t.oneOffs-1:0);else t.oneOffs=0}return s},on:function(e,n,t){var r,i,o,u,l,a=this,s=a.$PB;if(e&&e.length&&q(n,V)){if(t=!!t,i=e.split(Fn).map(Yn),!(l=i.length))return a;for(u=0;l>u;u++)e=i[u][0],r=i[u][1].join("."),o="evt_"+e,s[rn](o)||(s[o]=[],s[o].oneOffs=0),s[o].push([n,r,t,0]),t&&s[o].oneOffs++}return a},onTo:function(e,n,t,r){var i=this;return q(t,V)&&(t=c(t,i)),e.on(n,t,r),i},off:function(e,n){var t,r,i,o,u,l,a,s,c,f,d,h=this,p=h.$PB;if(e&&e.length){for(a=q(n,V),s=e.split(Fn).map(Yn),c=0,f=s.length;f>c;c++)if(e=s[c][0],l=Un(s[c][1]),e.length){if(d="evt_"+e,p[rn](d)&&(t=p[d])&&(o=t.length))for(i=o-1;i>=0;i--)u=t[i],a&&n!==u[0]||l&&!l.test(u[1])||(u[2]&&(t.oneOffs=t.oneOffs>0?t.oneOffs-1:0),t.splice(i,1))}else if(a||l)for(r in p)if(p[rn](r)){if(t=p[r],!t||!(o=t.length))continue;for(i=o-1;i>=0;i--)u=t[i],a&&n!==u[0]||l&&!l.test(u[1])||(u[2]&&(t.oneOffs=t.oneOffs>0?t.oneOffs-1:0),t.splice(i,1))}}else for(r in p)p[rn](r)&&delete p[r];return h},offFrom:function(e,n,t){var r=this;return e.off(n,t),r}};et.publish=et.trigger;var nt=function(e,n){var t=this,r=arguments.length;t.$store={},t.$size=D,t.$interval=D,r>0&&e>0&&(t.$size=e),r>1&&n>0&&(t.$interval=n)};nt[f]={constructor:nt,$store:null,$size:null,$interval:null,dispose:function(){var e=this;return e.$store=null,e.$size=null,e.$interval=null,e},reset:function(){return this.$store={},this},size:function(e){return arguments.length?(e>0&&(this.$size=e),this):this.$size},interval:function(e){return arguments.length?(e>0&&(this.$interval=e),this):this.$interval},has:function(e){var n=this,t=e?n.$store["_"+e]:null;return!!(t&&Tn()-t.time<=n.$interval)},get:function(e){if(e){var n,t=this,r=t.$store,i="_"+e;if(r[rn](i))return n=r[i],Tn()-n.time>t.$interval?(delete r[i],s):n.data}return s},set:function(e,n){var t,r,i,o,u=this;if(e){for(o="_"+e,t=u.$store,r=u.$size,i=$(t);i.length>=r;)delete t[i.shift()];t[o]={key:e,data:n,time:Tn()}}return u},del:function(e){var n=e?"_"+e:null;return n&&this.$store[rn](n)&&delete this.$store[n],this},toString:function(){return"[ModelView.Cache]"}};var tt=function $r(e){return M(this,$r)?void(this.f=e||null):new $r(e)},rt=function yr(e){return M(this,yr)?(this.f=e||null,void(this.fEach=1)):new yr(e)},it=Math.floor,ot=Math.round,ut=Math.abs,lt=function(e,n){return n.length-e.length},at=function(e){return Q(e.sort(lt),A).join("|")},st=function(e,n,t){var r=e.toString(),i=n-r.length;return i>0?new Array(i+1).join(t||" ")+r:r},ct={meridian:{am:"am",pm:"pm",AM:"AM",PM:"PM"},ordinal:{ord:{1:"st",2:"nd",3:"rd"},nth:"th"},timezone:["UTC","EST","MDT"],timezone_short:["UTC","EST","MDT"],day:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],month:["January","February","March","April","May","June","July","August","September","October","November","December"],month_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},ft={d:function(e,n){return n[rn]("d")||(n.d="(31|30|29|28|27|26|25|24|23|22|21|20|19|18|17|16|15|14|13|12|11|10|09|08|07|06|05|04|03|02|01)"),n.d},D:function(e,n){return n[rn]("D")||(n.D="("+at(e.day_short.slice())+")"),n.D},l:function(e,n){return n[rn]("l")||(n.l="("+at(e.day.slice())+")"),n.l},j:function(e,n){return n[rn]("j")||(n.j="(31|30|29|28|27|26|25|24|23|22|21|20|19|18|17|16|15|14|13|12|11|10|9|8|7|6|5|4|3|2|1)"),n.j},N:function(e,n){return n[rn]("N")||(n.N="([1-7])"),n.N},S:function(e,n){if(!n[rn]("S")){var t,r=e.ordinal.ord,i=[];for(t in r)r[rn](t)&&i.push(r[t]);i.push(e.ordinal.nth),n.S="("+at(i)+")"}return n.S},w:function(e,n){return n[rn]("w")||(n.w="([0-6])"),n.w},z:function(e,n){return n[rn]("z")||(n.z="([1-3]?[0-9]{1,2})"),n.z},W:function(e,n){return n[rn]("W")||(n.W="([0-5]?[0-9])"),n.W},F:function(e,n){return n[rn]("F")||(n.F="("+at(e.month.slice())+")"),n.F},M:function(e,n){return n[rn]("M")||(n.M="("+at(e.month_short.slice())+")"),n.M},m:function(e,n){return n[rn]("m")||(n.m="(12|11|10|09|08|07|06|05|04|03|02|01)"),n.m},n:function(e,n){return n[rn]("n")||(n.n="(12|11|10|9|8|7|6|5|4|3|2|1)"),n.n},t:function(e,n){return n[rn]("t")||(n.t="(31|30|29|28)"),n.t},L:function(e,n){return n[rn]("L")||(n.L="([01])"),n.L},o:function(e,n){return n[rn]("o")||(n.o="(\\d{2,4})"),n.o},Y:function(e,n){return n[rn]("Y")||(n.Y="([12][0-9]{3})"),n.Y},y:function(e,n){return n[rn]("y")||(n.y="([0-9]{2})"),n.y},a:function(e,n){return n[rn]("a")||(n.a="("+at([e.meridian.am,e.meridian.pm])+")"),n.a},A:function(e,n){return n[rn]("A")||(n.A="("+at([e.meridian.AM,e.meridian.PM])+")"),n.A},B:function(e,n){return n[rn]("B")||(n.B="([0-9]{3})"),n.B},g:function(e,n){return n[rn]("g")||(n.g="(12|11|10|9|8|7|6|5|4|3|2|1)"),n.g},G:function(e,n){return n[rn]("G")||(n.G="(23|22|21|20|19|18|17|16|15|14|13|12|11|10|9|8|7|6|5|4|3|2|1|0)"),n.G},h:function(e,n){return n[rn]("h")||(n.h="(12|11|10|09|08|07|06|05|04|03|02|01)"),n.h},H:function(e,n){return n[rn]("H")||(n.H="(23|22|21|20|19|18|17|16|15|14|13|12|11|10|09|08|07|06|05|04|03|02|01|00)"),n.H},i:function(e,n){return n[rn]("i")||(n.i="([0-5][0-9])"),n.i},s:function(e,n){return n[rn]("s")||(n.s="([0-5][0-9])"),n.s},u:function(e,n){return n[rn]("u")||(n.u="([0-9]{6})"),n.u},I:function(e,n){return n[rn]("I")||(n.I="([01])"),n.I},O:function(e,n){return n[rn]("O")||(n.O="([+-][0-9]{4})"),n.O},P:function(e,n){return n[rn]("P")||(n.P="([+-][0-9]{2}:[0-9]{2})"),n.P},Z:function(e,n){return n[rn]("Z")||(n.Z="(-?[0-9]{5})"),n.Z},e:function(e,n){return n[rn]("e")||(n.e="("+at(e.timezone)+")"),n.e},T:function(e,n){return n[rn]("T")||(n.T="("+at(e.timezone_short)+")"),n.T},U:function(e,n){return n[rn]("U")||(n.U="([0-9]{1,8})"),n.U},c:function(e,n){return n[rn]("c")||(n.c=ft.Y(e,n)+"-"+ft.m(e,n)+"-"+ft.d(e,n)+"\\\\"+ft.T(e,n)+ft.H(e,n)+":"+ft.i(e,n)+":"+ft.s(e,n)+ft.P(e,n)),n.c},r:function(e,n){return n[rn]("r")||(n.r=ft.D(e,n)+",\\s"+ft.d(e,n)+"\\s"+ft.M(e,n)+"\\s"+ft.Y(e,n)+"\\s"+ft.H(e,n)+":"+ft.i(e,n)+":"+ft.s(e,n)+"\\s"+ft.O(e,n)),n.r}},dt={d:function(e,n,t){return e=parseInt("0"===e.charAt(0)?e.slice(1):e,10),1>e||e>31?!1:t[rn]("day")&&e!==t.day?!1:void(t.day=e)},D:function(e,n,t){return e=n.day_short.indexOf(e),0>e?!1:t[rn]("day_week")&&e!==t.day_week?!1:void(t.day_week=e)},j:function(e,n,t){return e=parseInt(e,10),1>e||e>31?!1:t[rn]("day")&&e!==t.day?!1:void(t.day=e)},l:function(e,n,t){return e=n.day.indexOf(e),0>e?!1:t[rn]("day_week")&&e!==t.day_week?!1:void(t.day_week=e)},N:function(e,n,t){return e=parseInt(e,10),1>e||e>7?!1:(7===e&&(e=0),t[rn]("day_week")&&e!==t.day_week?!1:void(t.day_week=e))},S:null,w:function(e,n,t){return e=parseInt(e,10),0>e||e>6?!1:t[rn]("day_week")&&e!==t.day_week?!1:void(t.day_week=e)},z:function(e,n,t){return e=parseInt(e,10),0>e||e>366?!1:t[rn]("day_year")&&e!==t.day_year?!1:void(t.day_year=e)},W:function(e,n,t){return e=parseInt(e,10),1>e||e>53?!1:t[rn]("week_year")&&e!==t.week_year?!1:void(t.week_year=e)},F:function(e,n,t){return e=n.month.indexOf(e),0>e?!1:t[rn]("month")&&e+1!==t.month?!1:void(t.month=e+1)},m:function(e,n,t){return e=parseInt("0"===e.charAt(0)?e.slice(1):e,10),1>e||e>12?!1:t[rn]("month")&&e!==t.month?!1:void(t.month=e)},M:function(e,n,t){return e=n.month_short.indexOf(e),0>e?!1:t[rn]("month")&&e+1!==t.month?!1:void(t.month=e+1)},n:function(e,n,t){return e=parseInt(e,10),1>e||e>12?!1:t[rn]("month")&&e!==t.month?!1:void(t.month=e)},t:function(e,n,t){return e=parseInt(e,10),28>e||e>31?!1:t[rn]("days_month")&&e!==t.days_month?!1:void(t.days_month=e)},L:function(e,n,t){if("0"===e)t.leap=0;else{if("1"!==e)return!1;t.leap=1}},o:null,Y:function(e,n,t){return e=parseInt(e,10),1e3>e||e>3e3?!1:t[rn]("year")&&e!==t.year?!1:void(t.year=e)},y:function(e,n,t){return 2===e.length&&(e>="00"&&"69">=e?e="20"+e:e>="70"&&"99">=e&&(e="19"+e)),e=parseInt(e,10),1e3>e||e>3e3?!1:t[rn]("year")&&e!==t.year?!1:void(t.year=e)},a:function(e,n,t){if(n.meridian.am===e)e="am";else{if(n.meridian.pm!==e)return!1;e="pm"}return t[rn]("meridian")&&e!==t.meridian?!1:void(t.meridian=e)},A:function(e,n,t){if(n.meridian.AM===e)e="am";else{if(n.meridian.PM!==e)return!1;e="pm"}return t[rn]("meridian")&&e!==t.meridian?!1:void(t.meridian=e)},B:null,g:function(e,n,t){return e=parseInt(e,10),1>e||e>12?!1:t[rn]("hour_12")&&e!==t.hour_12?!1:void(t.hour_12=e)},G:function(e,n,t){return e=parseInt(e,10),0>e||e>23?!1:t[rn]("hour")&&e!==t.hour?!1:void(t.hour=e)},h:function(e,n,t){return e=parseInt("0"===e.charAt(0)?e.slice(1):e,10),1>e||e>12?!1:t[rn]("hour_12")&&e!==t.hour_12?!1:void(t.hour_12=e)},H:function(e,n,t){return e=parseInt("0"===e.charAt(0)?e.slice(1):e,10),0>e||e>23?!1:t[rn]("hour")&&e!==t.hour?!1:void(t.hour=e)},i:function(e,n,t){return e=parseInt("0"===e.charAt(0)?e.slice(1):e,10),0>e||e>59?!1:t[rn]("minute")&&e!==t.minute?!1:void(t.minute=e)},s:function(e,n,t){return e=parseInt("0"===e.charAt(0)?e.slice(1):e,10),0>e||e>59?!1:t[rn]("second")&&e!==t.second?!1:void(t.second=e)},u:function(e,n,t){for(var r=0;e.length>1&&"0"===e.charAt(r);)r++;return e=parseInt(e.slice(r),10),e=~~(e/1e3),0>e||e>999?!1:t[rn]("ms")&&e!==t.ms?!1:void(t.ms=e)},e:null,I:null,O:null,P:null,T:null,Z:null,U:function(e,n,t){return e=parseInt(e,10),0>e?!1:(e*=1e3,t[rn]("time")&&e!==t.time?!1:void(t.time=e))},c:null,r:null},ht={G:function(e,n,t){return t[rn]("G")||(t.G=e.getHours()),t.G},j:function(e,n,t){return t[rn]("j")||(t.j=e.getDate(),t.jmod10=t.j%10),t.j},n:function(e,n,t){return t[rn]("n")||(t.n=e.getMonth()+1),t.n},Y:function(e,n,t){return t[rn]("Y")||(t.Y=e.getFullYear()),t.Y},w:function(e,n,t){return t[rn]("w")||(t.w=e.getDay()),t.w},N:function(e,n,t){return t[rn]("N")||(t.N=ht.w(e,n,t)||7),t.N},d:function(e,n,t){return t[rn]("d")||(t.d=st(ht.j(e,n,t),2,"0")),t.d},D:function(e,n,t){return t[rn]("D")||(t.D=n.day_short[ht.w(e,n,t)]),t.D},l:function(e,n,t){return t[rn]("l")||(t.l=n.day[ht.w(e,n,t)]),t.l},S:function(e,n,t){if(!t[rn]("S")){var r=ht.j(e,n,t),i=t.jmod10;t.S=n.ordinal.ord[r]?n.ordinal.ord[r]:n.ordinal.ord[i]?n.ordinal.ord[i]:n.ordinal.nth}return t.S},z:function(e,n,t){if(!t[rn]("z")){var r=ht.Y(e,n,t),i=ht.n(e,n,t),o=ht.j(e,n,t);t.z=ot((new Date(r,i-1,o)-new Date(r,0,1))/864e5)}return t.z},W:function(e,n,t){if(!t[rn]("W")){var r=ht.Y(e,n,t),i=ht.n(e,n,t),o=ht.N(e,n,t),u=ht.j(e,n,t);t.W=st(1+ot((new Date(r,i-1,u-o+3)-new Date(r,0,4))/864e5/7),2,"0")}return t.W},F:function(e,n,t){if(!t[rn]("F")){var r=ht.n(e,n,t);t.F=n.month[r-1]}return t.F},m:function(e,n,t){if(!t[rn]("m")){var r=ht.n(e,n,t);t.m=st(r,2,"0")}return t.m},M:function(e,n,t){if(!t[rn]("M")){var r=ht.n(e,n,t);t.M=n.month_short[r-1]}return t.M},t:function(e,n,t){if(!t[rn]("t")){var r=ht.n(e,n,t),i=ht.Y(e,n,t);t.t=new Date(i,r,0).getDate()}return t.t},L:function(e,n,t){if(!t[rn]("L")){var r=ht.Y(e,n,t);t.L=r%4===0&r%100!==0|r%400===0}return t.L},o:function(e,n,t){if(!t[rn]("o")){var r=ht.Y(e,n,t),i=ht.n(e,n,t),o=ht.W(e,n,t);t.o=r+(12===i&&9>o?1:1===i&&o>9?-1:0)}return t.o},y:function(e,n,t){if(!t[rn]("y")){var r=ht.Y(e,n,t);t.y=r.toString().slice(-2)}return t.y},a:function(e,n,t){if(!t[rn]("a")){var r=ht.G(e,n,t);t.a=r>11?n.meridian.pm:n.meridian.am}return t.a},A:function(e,n,t){if(!t[rn]("A")){var r=ht.G(e,n,t);t.A=r>11?n.meridian.PM:n.meridian.AM}return t.A},B:function(e,n,t){return t[rn]("B")||(t.B=st(it((3600*e.getUTCHours()+60*e.getUTCMinutes()+e.getUTCSeconds()+3600)/86.4)%1e3,3,"0")),t.B},g:function(e,n,t){if(!t[rn]("g")){var r=ht.G(e,n,t);t.g=r%12||12}return t.g},h:function(e,n,t){if(!t[rn]("h")){var r=ht.g(e,n,t);t.h=st(r,2,"0")}return t.h},H:function(e,n,t){if(!t[rn]("H")){var r=ht.G(e,n,t);t.H=st(r,2,"0")}return t.H},i:function(e,n,t){return t[rn]("i")||(t.i=st(e.getMinutes(),2,"0")),t.i},s:function(e,n,t){return t[rn]("s")||(t.s=st(e.getSeconds(),2,"0")),t.s},u:function(e,n,t){return t[rn]("u")||(t.u=st(1e3*e.getMilliseconds(),6,"0")),t.u},e:function(){return""},I:function(e,n,t){if(!t[rn]("I")){var r=ht.Y(e,n,t);t.I=new Date(r,0)-Date.UTC(r,0)!==new Date(r,6)-Date.UTC(r,6)?1:0}return t.I},O:function(e,n,t){if(!t[rn]("O")){var r=e.getTimezoneOffset(),i=ut(r);t.O=(r>0?"-":"+")+st(100*it(i/60)+i%60,4,"0")}return t.O},P:function(e,n,t){if(!t[rn]("P")){var r=ht.O(e,n,t);t.P=r.substr(0,3)+":"+r.substr(3,2)}return t.P},T:function(){return"UTC"},Z:function(e,n,t){return t[rn]("Z")||(t.Z=60*-e.getTimezoneOffset()),t.Z},U:function(e,n,t){return t[rn]("U")||(t.U=e/1e3|0),t.U},c:function(e,n,t){if(!t[rn]("c")){var r=ht.Y(e,n,t),o=ht.m(e,n,t),u=ht.d(e,n,t),l=ht.T(e,n,t),a=ht.H(e,n,t),s=(ht.i(e,n,t),ht.s(e,n,t)),c=ht.P(e,n,t);t.c=[r,"-",o,"-",u,"\\",l,a,":",i,":",s,c].join("")}return t.c},r:function(e,n,t){if(!t[rn]("r")){var r=ht.Y(e,n,t),o=ht.M(e,n,t),u=ht.D(e,n,t),l=ht.d(e,n,t),a=ht.H(e,n,t),s=(ht.i(e,n,t),ht.s(e,n,t)),c=ht.O(e,n,t);t.r=[u,", ",l," ",o," ",r," ",a,":",i,":",s," ",c].join("")}return t.r}},pt=function(e,n){n=n||ct;var t,r,i,o="",u={};for(r=0,i=e.length;i>r;r++)t=e.charAt(r),o+=ft[rn](t)?ft[t](n,u):A(t);return new RegExp("^"+o+"$","")},gt=function(e,n){n=n||ct;var t,r,i,o,u=pt(e,n),l=0,a={};for(r=0,i=e.length;i>r;r++)if(t=e.charAt(r),dt[rn](t))if(dt[t])if(dt[t].push)for(o=0;o<dt[t].length;o++)null===dt[t][o]?++l:a[++l]=dt[t][o];else a[++l]=dt[t];else++l;return function(e){var t,r,i,o=e.match(u);if(!o)return!1;for(i={},t=1;t<o.length;t++)if(a[rn](t)&&(r=a[t](o[t],n,i),!1===r))return!1;return mt(i)}},vt=function(e,n){return n=n||ct,function(t){var r,i,o,u,l,a;if(t.substr)return t;for(null==t?l=new Date:t instanceof Date?l=new Date(t):"number"==typeof t&&(l=new Date(1e3*t)),r="",a={},o=0,u=e.length;u>o;o++)i=e.charAt(o),r+=ht[rn](i)?ht[i](l,n,a):i;return r}},mt=function(e,n){var t,r,i,o,u,l,a,s=0,c=[31,28,31,30,31,30,31,31,30,31,30,31],f=null,d=null,h=new Date;if(n=n||{},e[rn]("time")&&(d=new Date(e.time),e[rn]("year")||e[rn]("month")||e[rn]("day")||(f=new Date(d))),null===f){if(a=e[rn]("ms")?e.ms:n[rn]("ms")?n.ms:0,l=e[rn]("second")?e.second:n[rn]("second")?n.second:0,u=e[rn]("minute")?e.minute:n[rn]("minute")?n.minute:0,o=e[rn]("hour")?e.hour:e[rn]("hour_12")?"pm"===e.meridian?11+e.hour_12:e.hour_12-1:n[rn]("hour")?n.hour:"pm"===e.meridian?12:0,i=e[rn]("day")?e.day:n[rn]("day")?n.day:h.getDate(),r=e[rn]("month")?e.month:n[rn]("month")?n.month:h.getMonth()+1,t=e[rn]("year")?e.year:n[rn]("year")?n.year:h.getFullYear(),0>a||a>999)return!1;if(0>l||l>59)return!1;if(0>u||u>59)return!1;if(0>o||o>23)return!1;if(1>t||t>32767)return!1;if(s=t%4===0&t%100!==0|t%400===0,e[rn]("leap")&&s!==e.leap)return!1;if(c[1]+=s,1>r||r>12)return!1;if(1>i||i>c[r-1])return!1;if(f=new Date(t,r-1,i,o,u,l,a),e[rn]("day_week")&&e.day_week!==f.getDay())return!1;if(e[rn]("day_year")&&e.day_year!==ot((new Date(t,r-1,i)-new Date(t,0,1))/864e5))return!1;if(e[rn]("days_month")&&e.days_month!==c[r-1])return!1;if(e[rn]("meridian")&&(o>11&&"am"===e.meridian||11>=o&&"pm"===e.meridian))return!1;if(null!==d){if(f.getFullYear()!==d.getFullYear())return!1;if(f.getMonth()!==d.getMonth())return!1;if(f.getDate()!==d.getDate())return!1;if(f.getHours()!==d.getHours())return!1;if(f.getHours()!==d.getHours())return!1;if(f.getMinutes()!==d.getMinutes())return!1;if(f.getSeconds()!==d.getSeconds())return!1}}return f},$t=/\$0/g,yt=function br(e){return e.NOT=function(){return br(function(n,t){return!e.call(this,n,t)})},e.AND=function(n){return br(function(t,r){var i=this;return e.call(i,t,r)&&n.call(i,t,r)})},e.OR=function(n){return br(function(t,r){var i=this;return e.call(i,t,r)||n.call(i,t,r)})},e.XOR=function(n){return br(function(t,r){var i=this,o=e.call(i,t,r),u=n.call(i,t,r);return o&&!u||u&&!o})},e.EQ=function(n,t){return br(!1!==t?function(t,r){var i=this,o=e.call(i,t,r),u=n.call(i,t,r);return o===u}:function(t,r){var i=this,o=e.call(i,t,r),u=n.call(i,t,r);return o==u})},e.NEQ=function(n,t){return br(!1!==t?function(t,r){var i=this,o=e.call(i,t,r),u=n.call(i,t,r);return o!==u}:function(t,r){var i=this,o=e.call(i,t,r),u=n.call(i,t,r);return o!=u})},e},bt={TypeCaster:function(e){return e},Cast:{COMPOSITE:function(){var e=arguments;return q(e[0],z)&&(e=e[0]),function(n,t){for(var r=e.length;r--;)n=e[r].call(this,n,t);return n}},EACH:rt,FIELDS:function(e){return e=tn({},e||{}),function(n){var t,r,i,o,u,l=this;for(t in e)if(e[rn](t))if(r=e[t],i=n[t],r.fEach&&q(i,z)){for(o=i.length,u=0;o>u;u++)i[u]=r.f.call(l,i[u]);n[t]=i}else n[t]=r.call(l,i);return n}},DEFAULT:function(e){return function(n){var t=X(n);return(U&t||N&t&&!wn(n).length)&&(n=e),n}},BOOL:function(e){if(q(e,N)&&e.length){var n=e.toLowerCase();return"true"===n||"on"===n||"1"===n}return!!e},INT:function(e){return parseInt(e,10)||0},FLOAT:function(e){return parseFloat(e,10)||0},MIN:function(e){return function(n){return e>n?e:n}},MAX:function(e){return function(n){return n>e?e:n}},CLAMP:function(e,n){if(e>n){var t=n;n=e,e=t}return function(t){return e>t?e:t>n?n:t}},TRIM:function(e){return wn(b(e))},LCASE:function(e){return b(e).toLowerCase()},UCASE:function(e){return b(e).toUpperCase()},PAD:function(e,n,t){return t=t||"L",function(r){var i,o,u=b(r),l=u.length,a=n-l;return a>0&&("LR"===t?(o=~~(a/2),i=a-o,u=new Array(i+1).join(e)+u+new Array(o+1).join(e)):"R"===t?u+=new Array(a+1).join(e):"L"===t&&(u=new Array(a+1).join(e)+u)),u}},STR:function(e){return""+e},DATETIME:function(e,n){return vt(e||"Y-m-d H:i:s",n||ct)},FORMAT:function(e){return q(e,N)?(e=new nr(e,$t),function(n){return e.render({$0:n})}):e instanceof nr?function(n){return e.render(n)}:q(e,V)?function(n){return e(n)}:function(e){return b(e)}}},add:function(e,n){return q(e,N)&&q(n,V)&&(bt.Cast[e]=n),bt},del:function(e){return q(e,N)&&bt.Cast[rn](e)&&delete bt.Cast[e],bt},toString:function(){return"[ModelView.Type]"}},_t={Validator:yt,Validate:{EACH:rt,FIELDS:function(e){return e=tn({},e||{}),yt(function(n){var t,r,i,o,u,l=this;for(t in e)if(e[rn](t))if(r=e[t],i=n[t],r.fEach&&q(i,z)){for(o=i.length,u=0;o>u;u++)if(!r.f.call(l,i[u]))return!1}else if(!r.call(l,i))return!1;return!0})},NUMERIC:yt(function(e){return J(e)}),EMPTY:yt(function(e){return!e||!wn(b(e)).length}),NOT_EMPTY:yt(function(e){return!!(e&&0<wn(b(e)).length)}),MAXLEN:function(e){return yt(S("v","return v.length <= "+(e||0)+";"))},MINLEN:function(e){return yt(S("v","return v.length >= "+(e||0)+";"))},MATCH:function(e){return yt(function(n){return e.test(n)})},NOT_MATCH:function(e){return yt(function(n){return!e.test(n)})},EQUAL:function(e,n){return yt(M(e,tt)?S("v","return this.$data."+e.f+" "+(!1!==n?"===":"==")+" v;"):!1!==n?function(n){return e===n}:function(n){return e==n})},NOT_EQUAL:function(e,n){return yt(M(e,tt)?S("v","return this.$data."+e.f+" "+(!1!==n?"!==":"!=")+" v;"):!1!==n?function(n){return e!==n}:function(n){return e!=n})},GREATER_THAN:function(e,n){return M(e,tt)?e="this.$data."+e.f:q(e,N)&&(e='"'+e+'"'),yt(S("v","return "+e+" "+(!1!==n?"<":"<=")+" v;"))},LESS_THAN:function(e,n){return M(e,tt)?e="this.$data."+e.f:q(e,N)&&(e='"'+e+'"'),yt(S("v","return "+e+" "+(!1!==n?">":">=")+" v;"))},BETWEEN:function(e,n,t){q(e,z)&&(t=n,n=e[1],e=e[0]);var r,i=M(e,tt),o=M(n,tt);return!i&&!o&&e>n&&(r=n,n=e,e=r),e=i?"this.$data."+e.f:q(e,N)?'"'+e+'"':e,n=o?"this.$data."+n.f:q(n,N)?'"'+n+'"':n,yt(!1!==t?S("v","return ( "+e+" < v ) && ( "+n+" > v );"):S("v","return ( "+e+" <= v ) && ( "+n+" >= v );"))},NOT_BETWEEN:function(e,n,t){q(e,z)&&(t=n,n=e[1],e=e[0]);var r,i=M(e,tt),o=M(n,tt);return!i&&!o&&e>n&&(r=n,n=e,e=r),e=i?"this.$data."+e.f:q(e,N)?'"'+e+'"':e,n=o?"this.$data."+n.f:q(n,N)?'"'+n+'"':n,yt(!1!==t?S("v","return ( "+e+" > v ) || ( "+n+" < v );"):S("v","return ( "+e+" >= v ) || ( "+n+" <= v );"))},IN:function(){var e=k.call(arguments);return q(e[0],z)&&(e=e[0]),yt(function(n){return-1<e.indexOf(n)})},NOT_IN:function(){var e=k.call(arguments);return q(e[0],z)&&(e=e[0]),yt(function(n){return 0>e.indexOf(n)})},MIN_ITEMS:function(e,n){return e=parseInt(e,10),yt(V===X(n)?function(t){return t.length>=e&&en(t,n).length>=e}:function(n){return n.length>=e
})},MAX_ITEMS:function(e,n){return e=parseInt(e,10),yt(V===X(n)?function(t){return en(t,n).length<=e}:function(n){return n.length<=e})},EMAIL:function(e){return yt(function(n){return e.test(n)})}(/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),URL:function(e){return yt(function(n){return e.test(n)})}(new p("^(?!mailto:)(?:(?:http|https|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i")),DATETIME:function(e,n){var t=gt(e||"Y-m-d H:i:s",n||ct);return yt(function(e){return!1!==t(e)})}},add:function(e,n){return q(e,N)&&q(n,V)&&(_t.Validate[e]=q(n.XOR,V)?n:yt(n)),_t},del:function(e){return q(e,N)&&_t.Validate[rn](e)&&delete _t.Validate[e],_t},toString:function(){return"[ModelView.Validation]"}};dt.c=[dt.Y,dt.m,dt.d,null,dt.H,dt.i,dt.s,null],dt.r=[dt.D,dt.d,dt.M,dt.Y,dt.H,dt.i,dt.s,null];var wt=function(e,n){if(!e)return null;var t,r,i=[],o=e.length;for(t=0;o>t;t++)r=e[t],r&&(r[rn](n)&&i.push(r[n].n),r[rn](Wn)&&i.push(r[Wn].n));return i.length?i:null},kt=function(e,n){if(!e)return null;var t,r,i=e.length;if(s!==n){for(t=0;i>t;t++)if(r=e[t]){if(r[rn](n)&&r[n].v)return r[n].v;if(r[rn](Wn)&&r[Wn].v)return r[Wn].v}}else for(t=0;i>t;t++)if(r=e[t],r&&r.v)return r.v;return null},Tt=function(e,n,t,r){for(var i,o=t,u=0,l=n.length;l>u;)i=n[u++],o[rn](i)||(o[i]=new Bn),o=o[i],l>u?o=o.n:r?(o.n[rn](Wn)||(o.n[Wn]=new Bn),o.n[Wn].v=e):o.v=e;return t},Et=function(e,n,t,r){for(var i,o,u=n,l=t?[t]:null,a=0,s=e.length;s>a;){if(i=e[a++],o=X(u),!(s>a))return l&&kt(l,i)?!0:o&G&&u[rn](i)?!0:H===o&&"length"==i?!0:!1;if(o&G&&u[rn](i)){if(u=u[i],u instanceof r)return[r,u,e.slice(a)];l&&(l=wt(l,i))}else if(!l||!(l=wt(l,i)))return!1}return!1},St=function(e,n,t,r){for(var i,o,u=n,l=t?[t]:null,a=0,s=e.length;s>a;){if(i=e[a++],o=X(u),!(s>a))return l&&(l=kt(l,i))?[!1,l]:o&G&&u[rn](i)?[!0,u[i]]:H===o&&"length"==i?[!0,$(u).length]:!1;if(o&G&&u[rn](i)){if(u=u[i],u instanceof r)return[r,u,e.slice(a)];l&&(l=wt(l,i))}else if(!l||!(l=wt(l,i)))return!1}return!1},Mt=function(e,n,t,r){for(var i,o,u=n,l=t,a=0,s=e.length;s>a;){if(i=e[a++],o=X(u),!(s>a))return u[i]instanceof r?[r,u[i],e.slice(a)]:l&&o&G&&u[rn](i)?[!0,u,i,l]:!1;if(!(o&G&&u[rn](i)))return!1;if(u=u[i],u instanceof r)return[r,u,e.slice(a)];if(!l||!(l=wt(l,i)))return!1}return!1},Dt=function(e,n,t,r,i,o,u){var l,a,s=n,c=null,f=null,d=null,h=0,p=e.length;for(u=!1!==u,u&&(c=[t],f=[r],d=[i]);p>h;)if(l=e[h++],a=X(s),p>h)if(a&G&&s[rn](l)){if(s=s[l],s instanceof o)return[o,s,e.slice(h),0,null,null,null];u&&(c=wt(c,l),f=wt(f,l),d=wt(d,l))}else{if(!(u&&d&&(d=wt(d,l))))return[!1,s,l,e,null,null,null];c=wt(c,l),f=wt(f,l)}else if(a&G)return s[l]instanceof o?[o,s[l],e.slice(h),0,null,null,null]:s[rn](l)?[!0,s,l,e.slice(h),c,f,d]:[!1,s,l,e.slice(h),c,f,d];return[!1,s,l,e.slice(h),null,null,null]},xt=/\[([^\]]*)\]/g,At=/^\.+|\.+$/g,Ct=function(e){return e.replace(xt,".$1").replace(At,"")},Ot=function(e){return"["+e.split(".").join("][")+"]"},jt=function(e){var n=new p("^"+e+"([\\.|\\[])");return function(e,t){var r=e.replace(n,"$1");return t?Ct(r):r}},It=function _r(e,n,t,r){var i,o,u=!1;if(u=M(t,rt))t=t.f,Tt(t,-1<n.indexOf(".")?n.split("."):[n],r,u);else if(o=X(t),V&o)Tt(t,-1<n.indexOf(".")?n.split("."):[n],r,u);else if(G&o)for(i in t)t[rn](i)&&_r(e,n+"."+i,t[i],r)},Lt=function wr(e,n,t,r){var i,o;if(o=X(t),V&o)Tt(t,-1<n.indexOf(".")?n.split("."):[n],r);else if(G&o)for(i in t)t[rn](i)&&wr(e,n+"."+i,t[i],r)},Nt=function kr(e,n,t){var r,i;for(r in t)t[rn](r)&&(i=t[r],n[rn](r)?q(n[r],G)&&q(i,G)&&(n[r]=kr(e,n[r],i)):n[r]=i);return n},Pt=function Tr(e,n,t,r){var i,o;for(arguments.length<3&&(t=e.$data);t instanceof n;)t=t.data();if(o=r||X(t),t=H&o?tn({},t):z&o?t.slice(0):t,G&o)for(i in t)t[rn](i)&&(t[i]instanceof n?t[i]=Tr(t[i],n,tn({},t[i].data())):G&(o=X(t[i]))&&(t[i]=Tr(e,n,t[i],o)));return t},zt=function Er(e,n,t,r,i,o){var u,l,a,s,c,f,d;if(o=o?o+".":"",r=r||e.$data,i=i||[e.$types],i&&i.length)if(t){if(c=Mt(d=t.split("."),u=r,i,n))if(u=c[1],l=c[2],n===c[0])f=d.slice(0,d.length-l.length).join("."),Er(u,n,l.length?l.join("."):null);else if(f=d.slice(0,-1).join("."),a=u[l],s=kt(c[3],l),s&&(u[l]=s.call(e,a,o+t)),G&X(a)&&(i=wt(c[3],l))&&i.length){f+=f?"."+l:l,f=o+f;for(l in a)a[rn](l)&&Er(e,n,l,a,i,f)}}else if(G&X(r))for(l in r)r[rn](l)&&Er(e,n,l,r,i)},Ht=function Sr(e,n,t,r,i,o){var u,l,a,s,c,f,d,h,p,g={isValid:!0,errors:[]};if(i=i||e.$data,o=o||[e.$validators],o&&o.length)if(r){if(p=function(e){return d?d+"."+e:e},c=Mt(h=r.split("."),u=i,o,n))if(u=c[1],l=c[2],n===c[0]){if(d=h.slice(0,h.length-l.length).join("."),f=Sr(u,n,t,l.length?l.join("."):null),f.isValid||(g.errors=g.errors.concat(Q(f.errors,p)),g.isValid=!1),!g.isValid&&t)return g}else{if(d=h.slice(0,-1).join("."),a=u[l],s=kt(c[3],l),s&&!s.call(e,a,r)&&(g.errors.push(r),g.isValid=!1,t))return g;if(G&X(a)&&(o=wt(c[3],l))&&o.length){d+=d?"."+l:l;for(l in a)if(a[rn](l)&&(f=Sr(e,n,t,l,a,o),f.isValid||(g.errors=g.errors.concat(Q(f.errors,p)),g.isValid=!1),t&&!g.isValid))return g}}}else if(G&X(i))for(l in i)if(i[rn](l)&&(f=Sr(e,n,t,l,i,o),f.isValid||(g.errors=g.errors.concat(f.errors),g.isValid=!1),t&&!g.isValid))return g;return g},Vt=function(e,n){var t,r,i,o,u,l,a,s,c,f,d,h,p,g,v,m=e.target,y=m.$syncTo,b=n.key;if(b){for(r=b+".",i=$(y),o=i.length,p=m.atomic,g=m.$atom,m.atomic=!0,m.$atom=b,s=0;o>s;s++)if(c=i[s],c===b||kn(c,r))for(f=y[c],t=m.get(c),d=0,h=f.length;h>d;d++)l=f[d][0],u=f[d][1],m.__syncing[l.$id]=m.__syncing[l.$id]||[],v=m.__syncing[l.$id],0>v.indexOf(u)&&(v.push(u),(a=f[d][2])?a.call(l,u,t,c,m):l.set(u,t,1),v.pop());m.$atom=g,m.atomic=p}},Rt=function Mr(e,n,t,r,i,o,u){var l=this;return l instanceof Mr?(l.$id=Xn("Model"),l.namespace=l.id=e||l.$id,l.key=jt(l.id),l.$view=null,l.atomic=!1,l.$atom=null,l.$autovalidate=!0,l.$types={},l.$validators={},l.$getters={},l.$setters={},l.$idependencies={},l.$syncTo={},void l.data(n||{}).types(t).validators(r).getters(i).setters(o).dependencies(u).initPubSub()):new Mr(e,n,t,r,i,o,u)};Rt.count=function(e){if(!arguments.length)return 0;var n=X(e);return H===n?$(e).length:z===n?e.length:U!==n?1:0},Rt.Sorter=En,Rt.Field=tt,Rt[f]=tn(m(g[f]),et,{constructor:Rt,id:null,$id:null,$view:null,$data:null,$types:null,$idependencies:null,$validators:null,$getters:null,$setters:null,atomic:!1,$atom:null,$autovalidate:!0,$syncTo:null,$syncHandler:null,__syncing:null,dispose:function(){var e=this;return e.disposePubSub().$view=null,e.$data=null,e.$types=null,e.$idependencies=null,e.$validators=null,e.$getters=null,e.$setters=null,e.atomic=!1,e.$atom=null,e.key=null,e.$autovalidate=!1,e.$syncTo=null,e.$syncHandler=null,e.__syncing=null,e},view:function(e){var n=this;return arguments.length?(n.$view=e,n):n.$view},data:function(e){var n=this;return arguments.length?(n.$data=e,n):n.$data},dependencies:function(e){var n,t,r,i,o,u,l=this,a=l.$idependencies;if(q(e,H))for(n in e)if(e[rn](n))for(t=e[n]?[].concat(e[n]):[],r=0;r<t.length;r++)for(o=t[r].split("."),i=o[0],a[rn](i)||(a[i]=[]),0>a[i].indexOf(n)&&a[i].push(n),u=1;u<o.length;u++)i+="."+o[u],a[rn](i)||(a[i]=[]),0>a[i].indexOf(n)&&a[i].push(n);return l},defaults:function(e){var n,t,r=this,i=r.$data;if(q(e,H))for(n in e)e[rn](n)&&(t=e[n],i[rn](n)?q(i[n],G)&&q(t,G)&&(i[n]=Nt(r,i[n],t)):i[n]=t);return r},types:function(e){var n,t=this;if(q(e,H))for(n in e)e[rn](n)&&It(t,n,e[n],t.$types);return t},validators:function(e){var n,t=this;if(q(e,H))for(n in e)e[rn](n)&&It(t,n,e[n],t.$validators);return t},getters:function(e){var n,t=this;if(q(e,H))for(n in e)e[rn](n)&&Lt(t,n,e[n],t.$getters);return t},setters:function(e){var n,t=this;if(q(e,H))for(n in e)e[rn](n)&&Lt(t,n,e[n],t.$setters);return t},serialize:function(){return Pt(this,Rt)},typecast:function(e){return zt(this,Rt,e),this},validate:function(e,n){return Ht(this,Rt,!!e,n)},autovalidate:function(e){var n=this;return arguments.length?(n.$autovalidate=!!e,n):n.$autovalidate},has:function(e,n){var t,r=this,i=r.$data,o=r.$getters;return 0>e.indexOf(".")&&(i[rn](e)||!n&&(t=o[e]||o[Wn])&&t.v)?!0:(t=Et(e.split("."),i,n?null:o,Rt))?!0===t?!0:t[1].has(t[2].join(".")):!1},get:function(e,n){var t,r=this,i=r.$data,o=r.$getters;return 0>e.indexOf(".")?!n&&(t=o[e]||o[Wn])&&t.v?t.v.call(r,e):i[e]:(t=St(e.split("."),i,n?null:o,Rt))?Rt===t[0]?t[1].get(t[2].join("."),n):!1===t[0]?t[1].call(r,e):t[1]:s},getAll:function(e,n){var t,r,i,o,u,l,a,s,c,f,d,h,p,g,v,m,y,b=this,_=[];if(!e||!e.length)return _;for(e.substr&&(e=[e]),n=!0===n,g=b.$data,d=n?null:[b.$getters],o=0,u=e.length;u>o;o++)for(y=e[o],v=[[g,y,d]];v.length;)for(m=v.pop(),c=m[0],y=m[1],h=m[2],l=y.split("."),s=0,a=l.length;a>s;)if(i=l[s++],a>s)if(f=X(c),f&H){if(Wn===i){for(i=l.slice(s).join("."),t=$(c),r=0;r<t.length;r++)v.push([c,t[r]+"."+i,wt(h,t[r])]);break}c[rn](i)&&(c=c[i],h=wt(h,i))}else{if(!(f&z))break;if(Wn===i){for(i=l.slice(s).join("."),r=0;r<c.length;r++)v.push([c,""+r+"."+i,wt(h,""+r)]);break}c[rn](i)&&(c=c[i],h=wt(h,i))}else if(f=X(c),f&H)if(Wn===i)for(t=$(c),r=0;r<t.length;r++)_.push(n?c[t[r]]:(p=kt(h,t[r]))||(p=kt(h,i))?p.call(b,c[t[r]]):c[t[r]]);else!n&&(p=kt(h,i))?_.push(p.call(b,c[i])):c[rn](i)&&_.push(c[i]);else if(f&z)if(Wn===i)for(r=0;r<c.length;r++)_.push(n?c[r]:(p=kt(h,r))||(p=kt(h,i))?p.call(b,c[r]):c[r]);else!n&&(p=kt(h,i))?_.push(p.call(b,c[i])):c[rn](i)&&_.push(c[i]);return _},set:function(e,n,t,r){var i,o,u,l,a,s,c,f,d,h,p,g,v,m,$,y=this,b=null,_=null,w=!1,k=!1,T=y.$autovalidate;if(y.atomic&&kn(e,y.$atom))return y;if(u=y.$data,h=y.$types,p=y.$validators,g=y.$setters,v=y.$idependencies,w=z&X(n),0>e.indexOf("."))l=e,d=(i=g[l])?i.v:null,c=(i=h[l]||h[Wn])?i.v:null,f=T&&(i=p[l]||p[Wn])?i.v:null,w&&(c||(b=(o=h[l]||h[Wn])&&o.n[Wn]?o.n[Wn].v:null),T&&!f&&(_=(o=p[l]||p[Wn])&&o.n[Wn]?o.n[Wn].v:null)),k=!0;else if(i=Dt(e.split("."),u,h,T?p:null,g,Rt)){if(u=i[1],l=i[2],Rt===i[0])return l.length?(l=l.join("."),m=u.get(l),m!==n?u.set(l,n,t,r):t=!1):(m=u.data(),m!==n?u.data(n):t=!1),t&&(y.publish("change",{key:e,value:n,action:"set",valuePrev:m,$callData:r}),v[rn](e)&&y.notify(v[e])),y;if(d=kt(i[6],l),!d&&!1===i[0]&&i[3].length)return y;c=kt(i[4],l),f=kt(i[5],l),w&&(c||(b=kt(wt(i[4],l),Wn)),T&&!f&&(_=kt(wt(i[5],l),Wn))),k=!0}if(k){if(c)n=c.call(y,n,e);else if(b)for(a=0,s=n.length;s>a;a++)n[a]=b.call(y,n[a],e);if($=!0,f)$=f.call(y,n,e);else if(_)for(a=0,s=n.length;s>a;a++)if(!_.call(y,n[a],e)){$=!1;break}if(!$)return t&&(r&&(r.error=!0),y.publish("error",{key:e,value:u[l],action:"set",$callData:r})),y;if(d)return!1!==d.call(y,e,n,t)&&(t&&(y.publish("change",{key:e,value:n,action:"set",$callData:r}),v[rn](e)&&y.notify(v[e])),y.$atom&&e===y.$atom&&(y.atomic=!0)),y;m=u[l],m!==n&&(u[l]=n,t&&(y.publish("change",{key:e,value:n,valuePrev:m,action:"set",$callData:r}),v[rn](e)&&y.notify(v[e])),y.$atom&&e===y.$atom&&(y.atomic=!0))}return y},add:function(e,n,t,r){var i,o,u,l,a,c,f,d,h,p,g,v,m,$=this,y=-1,b=null,_=null,w=!1,k=!1,T=$.$autovalidate;if($.atomic&&kn(e,$.$atom))return $;if(o=$.$data,h=$.$types,p=$.$validators,g=$.$setters,v=$.$idependencies,w=z&X(n),0>e.indexOf("."))u=e,d=(i=g[u])&&i.n[Wn]?i.n[Wn].v:null,c=(i=h[u]||h[Wn])&&i.n[Wn]?i.n[Wn].v:null,f=T&&(i=p[u]||p[Wn])&&i.n[Wn]?i.n[Wn].v:null,w&&(c||(b=kt(wt(wt([h[u]||h[Wn]],Wn),Wn),Wn)),T&&!f&&(_=kt(wt(wt([p[u]||p[Wn]],Wn),Wn),Wn))),k=!0;else if(i=Dt(e.split("."),o,h,T?p:null,g,Rt)){if(o=i[1],u=i[2],Rt===i[0])return u.length?(u=u.join("."),o.add(u,n,t,r)):(y=0,o.data(n)),t&&($.publish("change",{key:e,value:n,action:"append",index:y,$callData:r}),v[rn](e)&&$.notify(v[e])),$;if(d=kt(wt(i[6],u),Wn),!d&&!1===i[0]&&i[3].length)return $;c=kt(wt(i[4],u),Wn),f=kt(wt(i[5],u),Wn),w&&(c||(b=kt(wt(wt(i[4],u),Wn),Wn)),T&&!f&&(_=kt(wt(wt(i[5],u),Wn),Wn))),k=!0}if(k){if(c)n=c.call($,n,e);else if(b)for(l=0,a=n.length;a>l;l++)n[l]=b.call($,n[l],e);if(m=!0,f)m=f.call($,n,e);else if(_)for(l=0,a=n.length;a>l;l++)if(!_.call($,n[l],e)){m=!1;break}if(!m)return t&&(r&&(r.error=!0),$.publish("error",{key:e,value:s,action:"append",index:-1,$callData:r})),$;if(d)return!1!==d.call($,e,n,t)&&(t&&(z===X(o[u])&&(y=o[u].length),$.publish("change",{key:e,value:n,action:"append",index:y,$callData:r}),v[rn](e)&&$.notify(v[e])),$.$atom&&e===$.$atom&&($.atomic=!0)),$;z===X(o[u])?(y=o[u].length,o[u].push(n)):(y=-1,o[u]=n),t&&($.publish("change",{key:e,value:n,action:"append",index:y,$callData:r}),v[rn](e)&&$.notify(v[e])),$.$atom&&e===$.$atom&&($.atomic=!0)}return $},ins:function(e,n,t,r,i){var o,u,l,a,c,f,d,h,p,g,v,m,$,y=this,b=null,_=null,w=!1,k=!1,T=y.$autovalidate;if(y.atomic&&kn(e,y.$atom))return y;if(u=y.$data,p=y.$types,g=y.$validators,v=y.$setters,m=y.$idependencies,w=z&X(n),0>e.indexOf("."))l=e,h=(o=v[l])&&o.n[Wn]?o.n[Wn].v:null,f=(o=p[l]||p[Wn])&&o.n[Wn]?o.n[Wn].v:null,d=T&&(o=g[l]||g[Wn])&&o.n[Wn]?o.n[Wn].v:null,k=!0,w&&(f||(b=kt(wt(wt([p[l]||p[Wn]],Wn),Wn),Wn)),T&&!d&&(_=kt(wt(wt([g[l]||g[Wn]],Wn),Wn),Wn)));else if(o=Dt(e.split("."),u,p,T?g:null,v,Rt)){if(u=o[1],l=o[2],Rt===o[0])return l.length?(l=l.join("."),u.ins(l,n,t,r,i)):u.data(n),r&&(y.publish("change",{key:e,value:n,action:"insert",index:t,$callData:i}),m[rn](e)&&y.notify(m[e])),y;if(h=kt(wt(o[6],l),Wn),!h&&!1===o[0]&&o[3].length)return y;f=kt(wt(o[4],l),Wn),d=kt(wt(o[5],l),Wn),w&&(f||(b=kt(wt(wt(o[4],l),Wn),Wn)),T&&!d&&(_=kt(wt(wt(o[5],l),Wn),Wn))),k=!0}if(k){if(f)n=f.call(y,n,e);else if(b)for(a=0,c=n.length;c>a;a++)n[a]=b.call(y,n[a],e);if($=!0,d)$=d.call(y,n,e);else if(_)for(a=0,c=n.length;c>a;a++)if(!_.call(y,n[a],e)){$=!1;break}if(!$)return r&&(i&&(i.error=!0),y.publish("error",{key:e,value:s,action:"insert",index:-1,$callData:i})),y;if(h)return!1!==h.call(y,e,n,r)&&(r&&(y.publish("change",{key:e,value:n,action:"insert",index:t,$callData:i}),m[rn](e)&&y.notify(m[e])),y.$atom&&e===y.$atom&&(y.atomic=!0)),y;z===X(u[l])?u[l].splice(t,0,n):(t=-1,u[l]=n),r&&(y.publish("change",{key:e,value:n,action:"insert",index:t,$callData:i}),m[rn](e)&&y.notify(m[e])),y.$atom&&e===y.$atom&&(y.atomic=!0)}return y},del:function(e,n,t,r){var i,o,u,l,a=this,c=-1,f=!1;if(a.atomic&&kn(e,a.$atom))return a;if(t=!1!==t,o=a.$data,0>e.indexOf("."))u=e,f=!0;else if(i=Dt(e.split("."),o,null,null,null,Rt,!1)){if(o=i[1],u=i[2],Rt===i[0]&&u.length)return u=u.join("."),l=o.get(u),o.del(u,t,n,r),n&&a.publish("change",{key:e,value:l,action:"delete",index:c,rearrange:t,$callData:r}),a.$atom&&e===a.$atom&&(a.atomic=!0),a;if(i[3].length)return a;f=!0}return f&&(l=o[u],o[u]=s,t?(T=X(o),z==T&&K(u)?(c=+u,o.splice(c,1)):H==T&&delete o[u]):delete o[u],n&&a.publish("change",{key:e,value:l,action:"delete",index:c,rearrange:t,$callData:r}),a.$atom&&e===a.$atom&&(a.atomic=!0)),a},delAll:function(e,n){var t,r,i,o,u,l,a,s,c,f,d,h,p,g,v=this;if(!e||!e.length)return v;for(e.substr&&(e=[e]),n=!1!==n,d=v.$data,o=0,u=e.length;u>o;o++)for(g=e[o],h=[[d,g]];h.length;)for(p=h.pop(),c=p[0],g=p[1],l=g.split("."),s=0,a=l.length;a>s;)if(i=l[s++],a>s)if(f=X(c),f&H){if(Wn===i){for(i=l.slice(s).join("."),t=$(c),r=0;r<t.length;r++)h.push([c,t[r]+"."+i]);break}c[rn](i)&&(c=c[i])}else{if(!(f&z))break;if(Wn===i){for(i=l.slice(s).join("."),r=0;r<c.length;r++)h.push([c,""+r+"."+i]);break}c[rn](i)&&(c=c[i])}else if(f=X(c),f&H)if(Wn===i)for(t=$(c),r=0;r<t.length;r++)delete c[t[r]];else c[rn](i)&&delete c[i];else if(f&z)if(Wn===i)for(r=c.length-1;r>=0;r--)n?c.splice(r,1):delete c[r];else c[rn](i)&&(n&&K(i)?c.splice(+i,1):delete c[i]);return v},sync:function(e,n){var t,r,i,o,u,l,a=this;for(t in n)if(n[rn](t)){for(r=n[t],a.$syncTo[t]=a.$syncTo[t]||[],i=null,z===X(r)&&(i=r[1]||null,r=r[0]),o=a.$syncTo[t],l=1,u=o.length-1;u>=0;u--)if(e===o[u][0]&&r===o[u][1]){o[u][2]=i,l=0;break}l&&o.push([e,r,i])}return a.$syncHandler||(a.__syncing=a.__syncing||{},a.on("change",a.$syncHandler=Vt)),a},unsync:function(e){var n,t,r,i=this,o=i.$syncTo;for(n in o)if(o[rn](n)){if(!(t=o[n])||!t.length)continue;for(r=t.length-1;r>=0;r--)e===t[r][0]&&(i.__syncing&&i.__syncing[e.$id]&&C(i.__syncing,e.$id),t.splice(r,1))}return i},notify:function(e,n,t){var r,i,o,u,l,a,s=this,c=s.$idependencies,f=[],d={};if(e){if(l=X(e),n=n||"change",o={key:"",action:"set"},t&&(t[rn]("value")&&(o.value=t.value),t[rn]("action")&&(o.action=t.action),t[rn]("index")&&(o.index=t.index),t[rn]("rearrange")&&(o.rearrange=t.rearrange),t[rn]("$callData")&&(o.$callData=t.$callData)),N===l)o.key=e,d["_"+e]=1,c[rn](e)&&(f=f.concat(c[e])),s.publish(n,o);else if(z===l)for(i=e.length,r=0;i>r;r++)o.key=u=e[r],d[rn]("_"+u)||(d["_"+u]=1,c[rn](u)&&(f=f.concat(c[u])),s.publish(n,o));for(;i=f.length;){for(a=[],o={key:"",action:"set"},r=0;i>r;r++)u=f[r],d[rn]("_"+u)||(d["_"+u]=1,c[rn](u)&&(a=a.concat(c[u])),o.key=u,s.publish("change",o));f=a}}return s},atom:function(e){var n=this;return s!==e&&(!1===e?(n.atomic=!1,n.$atom=null):(n.atomic=!1,n.$atom=e)),n},toString:function(){return"[ModelView.Model id: "+this.id+"]"}}),Rt[f].append=Rt[f].add,Rt[f].insert=Rt[f].ins,Rt[f].remove=Rt[f]["delete"]=Rt[f].del,Rt[f].deleteAll=Rt[f].delAll;var Ft="lastIndexOf",Yt="match",Ut="nodeValue",Bt="nodeType",Wt="parentNode",Gt="global",Zt="ignoreCase",Xt=/[a-zA-Z0-9_\-]/,qt=function(e){return parseInt(e,10)},Jt=function(e,n,t){for(var r,i,o,u,l,a,c,f,d,h,p=[],g=0,v=!1,m=-1,$=0,y=!1,b={};r=n.exec(e);){if(i=n.lastIndex-r[0].length,o=e.slice(g,i),d=-1,t&&(c=o[Ft]("<"),f=o[Ft](">"),c>f?(d=-1,y=!0):f>c&&(d=f+1,y=!1)),p.push([1,y,o,d]),y)if(-1<(l=o[Ft]("="))){for(v="",a=l;l>-1&&Xt.test(u=o.charAt(--l));)v=u+v;m=i-g-a-2,$=m+r[0].length}else v&&(m=$+i-g-2-1,$+=m+r[0].length);else v=!1,$=0,m=-1;h=r[1]?r[1]:r[0],b[rn](h)?b[h].push(p.length):b[h]=[p.length],p.push([0,y,h,s,v,m]),g=n.lastIndex}return o=e.slice(g),d=-1,t&&(c=o[Ft]("<"),f=o[Ft](">"),c>f?(d=-1,y=!0):f>c&&(d=f+1,y=!1)),p.push([1,y,o,d]),[b,p]},Kt=function(e,n,t){var r,i,o,u,l,a,s,c,f,d,h,p,g,v,m,$,y,b,_,w,k;if(i=[],o=[],d=e,d.attributes&&(l=d.attributes.length))if(t&&d.firstChild&&8===d.firstChild[Bt]&&"att:"===d.firstChild[Ut].slice(0,4))for(c=d.firstChild[Ut].split("\n"),l=c.length,v={},u=0;l>u;u++)a=c[u].split("|"),y=a[0].slice(4),h=d.attributes[y],v[rn](y)||(v[y]=[1,[]],o.push([h,v[y],d])),v[y][1].push([a[1].slice(4),a[2].split(",").map(qt)]);else for(u=0;l>u;u++)h=d.attributes[u],(a=h[Ut][Yt](n))&&o.push([0,h,a,d]);if(3===d[Bt])t&&d.previousSibling&&d.nextSibling&&8===d.previousSibling[Bt]&&8===d.nextSibling[Bt]&&"key:"===(p=d.previousSibling[Ut]).slice(0,4)&&"/key"===d.nextSibling[Ut]?(a=[d[Ut],p.slice(4)],i.push([d,a,d[Wt]])):(a=d[Ut][Yt](n))&&i.push([d,a,d[Wt]]);else if(d.firstChild)for(k=[d=d.firstChild];k.length;){if(d.attributes&&(l=d.attributes.length))if(t&&d.firstChild&&8===d.firstChild[Bt]&&"att:"===d.firstChild[Ut].slice(0,4))for(c=d.firstChild[Ut].split("\n"),l=c.length,v={},u=0;l>u;u++)a=c[u].split("|"),y=a[0].slice(4),h=d.attributes[y],v[rn](y)||(v[y]=[1,[]],o.push([h,v[y],d])),v[y][1].push([a[1].slice(4),a[2].split(",").map(qt)]);else for(u=0;l>u;u++)h=d.attributes[u],(a=h[Ut][Yt](n))&&o.push([h,a,d]);if(d.firstChild)k.push(d=d.firstChild);else{for(3===d[Bt]&&(t&&d.previousSibling&&d.nextSibling&&8===d.previousSibling[Bt]&&8===d.nextSibling[Bt]&&"key:"===(p=d.previousSibling[Ut]).slice(0,4)&&"/key"===d.nextSibling[Ut]?(a=[d[Ut],p.slice(4)],i.push([d,a,d[Wt]])):(a=d[Ut][Yt](n))&&i.push([d,a,d[Wt]])),d=k.pop();k.length&&!d.nextSibling;)d=k.pop();d.nextSibling&&k.push(d=d.nextSibling)}}for(r={},u=0,l=i.length;l>u;u++)if(s=i[u],w=s[0],a=s[1],d=s[2],$=w[Ut],$.length>a[0].length){do p=a[1]?a[1]:a[0],g=w.splitText(a.index),w=g.splitText(a[0].length),r[rn](p)?r[p][0].push([g,d]):r[p]=[[[g,d]],[]],a=w[Ut][Yt](n);while(a)}else p=a[1]?a[1]:a[0],g=w,r[rn](p)?r[p][0].push([g,d]):r[p]=[[[g,d]],[]];for(u=0,l=o.length;l>u;u++)if(s=o[u],h=s[0],a=s[1],d=s[2],$=h[Ut],w=document.createTextNode($||""),m=[[],[w]],1===a[0])for(c=a[1],f=c.length,_=0,u=0;f>u;u++)b=c[u],p=b[0],g=w.splitText(b[1][0]-_),w=g.splitText(b[1][1]),m[0].push(p),m[1].push(g,w),r[rn](p)?(r[p][0].push([g,d]),r[p][1].push([h,m[1],$,d])):r[p]=[[[g,d]],[[h,m[1],$,d]]],_+=b[1][1]+b[1][0];else if($.length>a[0].length){do p=a[1]?a[1]:a[0],g=w.splitText(a.index),w=g.splitText(a[0].length),m[0].push(p),m[1].push(g,w),r[rn](p)?(r[p][0].push([g,d]),r[p][1].push([h,m[1],$,d])):r[p]=[[[g,d]],[[h,m[1],$,d]]],a=w[Ut][Yt](n);while(a)}else g=w,p=a[1]?a[1]:a[0],m[0].push(p),r[rn](p)?(r[p][0].push([g,d]),r[p][1].push([h,m[1],$,d])):r[p]=[[[g,d]],[[h,m[1],$,d]]];return[r,e]},Qt=function(e){var n,t,r,i,o,u=this.$tpl[1],l=this.$revivable,a=u.length,s=[],c="";for(t=0;a>t;t++)n=u[t],r=n[0],o=n[1],i=n[2],r?(l&&!o&&n[3]>-1&&s.length&&(i=i.slice(0,n[3])+"<!--"+s.join("\n")+"-->"+i.slice(n[3]),s=[]),c+=i):(e[rn](i)&&(n[3]=String(e[i])),l?o?(c+=n[3],n[4]&&s.push("att:"+n[4]+"|key:"+i+"|"+[n[5],n[3].length].join(","))):c+="<!--key:"+i+"-->"+n[3]+"<!--/key-->":c+=n[3]);return c},er=function(e){var n,t,r,i,o,u,l,a,s,c,f,d,h,p,g=this.$tpl[0];for(i=$(e),l=i.length,u=0;l>u;u++)if(o=i[u],a=String(e[o]),g[rn](o)){for(s=g[o][0],t=0,r=s.length;r>t;t++)s[t][0][Ut]=a;for(c=g[o][1],t=0,r=c.length;r>t;t++){if(n=c[t],f=n[1],h=f.length,p=h?f[0][Ut]:"",h>1)for(d=1;h>d;d++)p+=f[d][Ut];n[0][Ut]=p}}return this},nr=function Dr(e,n,t){var r=this;return r instanceof Dr?(r.initPubSub(),r.$revivable=!0===t,void(e.substr&&e.substring?(r.$key=n[Gt]?n:new RegExp(n.source,n[Zt]?"gi":"g"),r.$tpl=Dr.multisplit_string(e,r.$key,r.$revivable),r.render=Qt):(r.$key=n[Gt]?new RegExp(n.source,n[Zt]?"i":""):n,r.$tpl=Kt(e,r.$key,r.$revivable),r.render=er))):new Dr(e,n,t)};nr.multisplit_string=Jt,nr.multisplit_node=Kt,nr[f]=tn(m(g[f]),et,{constructor:nr,id:null,$tpl:null,$key:null,$revivable:!1,dispose:function(){var e=this;return e.disposePubSub(),e.$key=null,e.$tpl=null,e.$revivable=null,e},keys:function(){return $(this.$tpl[0])},render:function(){},bind:function(e){var n=this;if(e){var t,r=n.$tpl[0],i=Kt(e,n.$key,!1)[0];for(t in i)i[rn](t)&&(r[rn](t)?(r[t][0]=r[t][0].concat(i[t][0]),r[t][1]=r[t][1].concat(i[t][1])):r[t]=i[t])}return n},free:function(e){var n=this;if(e){var t,r,i,o,u,l,a,s=n.$tpl[0],c=$(s),f=c.length;for(o=0;f>o;o++){for(t=c[o],u=s[t],l=u[0],i=l.length,r=i-1;r>=0;r--)e.contains(l[r][1])&&l.splice(r,1);for(a=u[1],i=a.length,r=i-1;r>=0;r--)e.contains(a[r][3])&&a.splice(r,1)}}return n},toString:function(){return"[ModelView.Tpl id: "+this.id+"]"}});var tr="mv_namedkey",rr=function(e,n){if(e)for(var t=0,r=e.length;r>t;t++)if(n==b(e[t]))return!0;return!1},ir=function(e,n){return new p(A(e).replace("__MODEL__",A(n||"")).replace("__KEY__","(\\S+?)"),"")},or=function(e,n,t){return[e?"["+e+"]":null,n?n[1]?"["+n[0]+'*="|'+n[1]+'"]':"["+n[0]+"]":null,t?t[1]?'input[name="'+t[0]+'"],textarea[name="'+t[0]+'"],select[name="'+t[0]+'"]':'input[name^="'+t[0]+'"],textarea[name^="'+t[0]+'"],select[name^="'+t[0]+'"]':null]},ur=function(e,n){return n&&n[e]?(q(n[e],N)&&(n[e]={action:n[e]}),n[e]):void 0},lr=/^\d+$/,ar=/\[\s*\]$/,sr=function(e,n){var t,r,i,o,u,l,a,s,c,f,d,h,p=e.$model,g=n.length,v=p.id+".",m={};for(t=0;g>t;t++)if(r=n[t],i=r[on]("name"))for(f=(r[dn]||"").toLowerCase(),o=Ct(i),kn(o,v)&&(o=o.slice(v.length)),u=o.split("."),a=p.$data;u.length;)l=u.shift(),u.length?(a[rn](l)||(a[l]=lr.test(u[0])?[]:{}),a=a[l]):"radio"===f?m[i]||(c="",h=e.get('input[type="radio"][name="'+i+'"]',0,1),h.length>1?nn(h,function(){r[ln]&&(c=r[hn])}):r[ln]&&(c=r[hn]),m[i]=1,p.set(o,c)):"checkbox"===f?m[i]||(d=ar.test(i),h=e.get('input[type="checkbox"][name="'+i+'"]',0,1),d?(c=[],nn(h,function(e){e[ln]&&c.push(e[hn])})):h.length>1?(c=[],nn(h,function(e){c.push(e[ln]?e[hn]:(s=e[on]("data-else"))?s:"")})):c=r[ln]?r[hn]:(s=r[on]("data-else"))?s:"",m[i]=1,p.set(o,c)):(c=Hn(r),p.set(o,c))},cr=function(e,n){var t,r,i,o,u,l,a,s,c,f,d,h={},p=n&&n.length?n+".":null,g=An("input,textarea,select",e),v=g.length,m={};for(t=0;v>t;t++)if(r=g[t],i=r[on]("name")){if(c=(r[dn]||"").toLowerCase(),o=Ct(i),p){if(!kn(o,p))continue;o=o.slice(p.length)}for(u=o.split("."),a=h;u.length;)l=u.shift(),u.length?(a[rn](l)||(a[l]=lr.test(u[0])?[]:{}),a=a[l]):(a[rn](l)||(a[l]=""),"radio"===c?m[i]||(s="",d=An('input[type="radio"][name="'+i+'"]',e),d.length>1?nn(d,function(){r[ln]&&(s=r[hn])}):r[ln]&&(s=r[hn]),m[i]=1,a[l]=s):"checkbox"===c?m[i]||(f=ar.test(i),d=An('input[type="radio"][name="'+i+'"]',e),f?(s=[],nn(d,function(e){e[ln]&&s.push(e[hn])})):d.length>1?(s=[],nn(d,function(e){s.push(e[ln]?e[hn]:(alternative=e[on]("data-else"))?alternative:"")})):s=r[ln]?r[hn]:(alternative=r[on]("data-else"))?alternative:"",m[i]=1,a[l]=s):(s=Hn(r),a[l]=s))}return h},fr=function(e,n,t,r){var i,o,u,l,a,s,c=e.$model,f="sync"==n.type,d=f?"change":n.type,h=t.length,p=r&&r.key?r.key:null,g=!p,v=p?p+".":null,m=c.atomic,$=c.$atom,y=m?$+".":null;for(i=0;h>i;i++)o=t[i],o&&(u=ur(d,e.attr(o,"bind")),u&&u[rn]("action")&&(l="do_"+u.action,q(e[l],V)&&(a=o[cn],s=u.key,s||(!o[tr]&&a&&(o[tr]=c.key(a,1)),s=o[tr]),m&&s&&($===s||kn(s,y))||p&&!s||(g||s===p||kn(s,v))&&e[l](n,o,u))))},dr=function(e,n,t){var r,i,o,u,l,a,s=e.$model,c={},f=t.length;for(r=0;f>r;r++)if(i=t[r],i&&(o=i[cn],u=0,!i[tr]&&o&&(i[tr]=s.key(o,1)),u=i[tr])){if(l="_"+u,c[rn](l))a=c[l][0];else{if(!s.has(u))continue;c[l]=[a=s.get(u)]}e.do_bind(n,i,{name:o,key:u,value:a})}},hr=function(e,n,t){var r,i,o,u,l=e.$model,a="sync"==n.type,s=!1,c=e.$tpl.keys(),f=c.length,d={};if(a)for(o=0;f>o;o++)u=c[o],d[u]=l.get(u),s=!0;else if(t&&t.key)for(r=t.key,i=r+".",o=0;f>o;o++)u=c[o],(r===u||kn(u,i))&&(d[u]=l.get(u),s=!0);s&&e.$tpl.render(d)},pr={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},gr={27:"escape",9:"tab",32:"space",13:"enter",8:"backspace",145:"scrolllock",20:"capslock",144:"numlock",19:"pause",45:"insert",36:"home",46:"delete",35:"end",33:"pageup",34:"pagedown",37:"left",38:"up",39:"right",40:"down",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12"},vr=function(e,n){return function(t){return e[n](t,{el:this})}},mr=function xr(e,n,t,r,i){var o=this;return o instanceof xr?(o.namespace=o.id=e||Xn("View"),(t=t||{})[rn]("bind")||(t.bind="data-bind"),o.$atts=t,r=r||xr._CACHE_SIZE,i=i||xr._REFRESH_INTERVAL,o.$memoize=new nt(r,D),o.$selectors=new nt(r,i),o.$atbind=o.attribute("bind"),o.$shortcuts={},o.$num_shortcuts=0,void o.model(n||new Rt).initPubSub()):new xr(e,n,t,r,i)};return mr._CACHE_SIZE=600,mr._REFRESH_INTERVAL=D,mr.node=Dn,mr.index=Sn,mr.indexClosest=Mn,mr.getDomRef=Cn,mr.serialize=cr,mr[f]=tn(m(g[f]),et,{constructor:mr,id:null,$dom:null,$tpl:null,$model:null,$livebind:null,$autobind:!1,$isomorphic:!1,$bindbubble:!1,$template:null,$atts:null,$memoize:null,$selectors:null,$atbind:null,$shortcuts:null,$num_shortcuts:null,dispose:function(){var e=this;return e.unbind().disposePubSub(),e.$model&&e.$model.dispose(),e.$model=null,e.$dom=null,e.$tpl&&e.$tpl.dispose(),e.$tpl=null,e.$template=null,e.$atts=null,e.$memoize.dispose(),e.$memoize=null,e.$selectors.dispose(),e.$selectors=null,e.$livebind=null,e.$isomorphic=null,e.$atbind=null,e.$shortcuts=null,e.$num_shortcuts=null,e},model:function(e){var n=this;return arguments.length?(n.$model&&n.$model.dispose(),n.$model=e.view(n),n):n.$model},attribute:function(e,n){var t=this;return arguments.length>1?(t.$atts[e]=n,t.$atbind=t.$atts.bind,t.$atkeys=t.$atts.keys,t):e?t.$atts[e]||s:s},template:function(e){var n=this;return arguments.length?(q(e,V)&&(n.$template=e),n):n.$template},events:function(e){var n,t=this;if(q(e,H))for(n in e)e[rn](n)&&q(e[n],V)&&(t["on_"+n.split(":").join("_")]=e[n]);return t},shortcuts:function(e){var n,t,r,i,o,u=this,l=u.$shortcuts;if(q(e,H))for(n in e)if(e[rn](n)){for(i=[],r=n.toLowerCase().split("+").map(wn),o=r.length-1;o>=0;o--)t=r[o],("alt"===t||"ctrl"===t||"shift"===t||"meta"===t)&&(i.push(t),r.splice(o,1));t=i.sort().concat(r).join("+"),!1===e[n]?l[rn](t)&&(C(l,t),u.$num_shortcuts--):(l[rn](t)||u.$num_shortcuts++,l[t]=e[n])}return u},actions:function(e){var n,t=this;if(q(e,H))for(n in e)e[rn](n)&&q(e[n],V)&&(t["do_"+n]=e[n]);return t},autovalidate:function(e){return arguments.length?(this.$model.autovalidate(e),this):this.$model.autovalidate()},livebind:function(e){var n=this;return arguments.length?(n.$livebind=e?ir(e,n.$model?n.$model.id:""):null,n):n.$livebind},isomorphic:function(e){var n=this;return arguments.length?(n.$isomorphic=!!e,n):n.$isomorphic},autobind:function(e){var n=this;return arguments.length?(n.$autobind=!!e,n):n.$autobind},bindbubble:function(e){var n=this;return arguments.length?(n.$bindbubble=!!e,n):n.$bindbubble},get:function(e,n,t,r){var i,o=this,u=o.$selectors;return n=n||o.$dom,(r||!(i=u.get(e)))&&(i=An(e,n),t&&n[On](e)&&i.push(n),r||u.set(e,i)),i},attr:function(e,n){var t,r,i=this,o=i.$atts[n],u=i.$memoize;return(o=e[on](o))?(t=u.get(o),s===t&&(t=_n(o),t.set&&(t.click=t.set,t.click.action="set",C(t,"set")),t.each&&(t.change={action:"each",key:t.each},C(t,"each")),t.show&&(t.change={action:"show",key:t.show},C(t,"show")),t.hide&&(t.change={action:"hide",key:t.hide},C(t,"hide")),t.html?(t.change={action:"html",key:t.html},C(t,"html"),C(t,"text")):t.text&&(t.change={action:"html",key:t.text,text:1},C(t,"text")),t.css&&(t.change={action:"css",css:t.css},C(t,"css")),t.value&&(t.change&&"prop"==t.change.action?t.change.prop.value=t.value:t.change={action:"prop",prop:{value:t.value}},C(t,"value")),t.checked&&(t.change&&"prop"==t.change.action?t.change.prop.checked=t.checked:t.change={action:"prop",prop:{checked:t.checked}},C(t,"checked")),t.disabled&&(t.change&&"prop"==t.change.action?t.change.prop.disabled=t.disabled:t.change={action:"prop",prop:{disabled:t.disabled}},C(t,"disabled")),t.options&&(t.change&&"prop"==t.change.action?t.change.prop.options=t.options:t.change={action:"prop",prop:{options:t.options}},C(t,"options")),(r=t.change)&&!r.key&&t.key&&(r.key=t.key),u.set(o,t)),t):s},add:function(e,n){var t=this;return e&&(t.$tpl&&t.$tpl.bind(e),!1!==n&&t.sync(null,e)),t},remove:function(e,n){var t=this;return e&&(t.$tpl&&t.$tpl.free(e),!1!==n&&t.$selectors.reset()),t},bind:function(e,t){var r,i,o,u=this,l=u.$model,s=or(u.$atbind,null,[l.id+"["]),c=s[0],f=s[2],d=u.$autobind,h=!!u.$livebind,p="undefined"!=typeof document;e=e||["change","click"],u.$dom=t||(p?document.body:null),o=function(e){return n(e,u.namespace)},h&&(u.$tpl=nr(u.$dom,u.$livebind,u.$isomorphic)),p&&u.on_view_change&&e.length&&a(u.$dom).on(Q(e,o).join(" "),d?[f,c].join(","):c,function(e){var n=this,t=!1,r=!1,i=u.$bindbubble?u.attr(n,"bind"):null;return(e.target===n||i&&i.bubble)&&(r=u.$bindbubble?!!i:n[On](c),t=d&&"change"==e.type&&n[On](f),(r||t)&&u.on_view_change(e,{el:n,isBind:r,isAutoBind:t})),!0});for(r in u)q(u[r],V)&&(kn(r,"on_model_")?(i=r.slice(9),i.length&&u.onTo(l,i,u[r])):p&&(kn(r,"on_document_")?(i=r.slice(12),i.length&&a(document.body).on(o(i),vr(u,r))):kn(r,"on_view_")&&"on_view_change"!==r?(i=r.slice(8),i.length&&a(u.$dom).on(o(i),d?[f,c].join(","):c,vr(u,r))):kn(r,"on_dom_")&&(i=r.slice(7),i.length&&a(u.$dom).on(o(i),vr(u,r)))));return u},unbind:function(e,t){var r,i,o=this,u=o.$model,l=or(o.$atbind,null,[u.id+"["]),s=n("",o.namespace),c=o.$autobind,f=(!!o.$livebind,"undefined"!=typeof document);return e=e||null,i=t||o.$dom,r=function(e){return n(e,o.namespace)},f&&o.on_view_change&&a(i).off(e&&e.length?Q(e,r).join(" "):s,c?[l[2],l[0]].join(","):l[0]),o.offFrom(u),f&&(a(i).off(s),a(document.body).off(s)),o.$tpl&&(o.$tpl.dispose(),o.$tpl=null),o},rebind:function(e,n){var t=this;return t.$memoize.reset(),t.$selectors.reset(),t.unbind().bind(e,n)},sync:function(e,n){var t,r,i,o=this,u=o.$autobind,l=!!o.$livebind,a=or(o.$atbind,null,u?[o.$model.id+"["]:0),s=Qn("sync",o),c="undefined"!=typeof document;return o.$selectors.reset(),n?(s.currentTarget=n,c&&(t=o.get(a[0],n,0,1),u&&(r=o.get(a[2],n,0,1)))):c&&(e=e||o.$dom,i=!(e===o.$dom),t=o.get(a[0],e,0,i),u&&(r=o.get(a[2],e,0,i))),c&&t.length&&fr(o,s,t),c&&u&&r.length&&dr(o,s,r),l&&o.$tpl&&hr(o,s),o},sync_model:function(e){var n,t,r=this,i=r.$autobind,o="undefined"!=typeof document;
return o&&i&&(n=or(null,null,[r.$model.id+"["]),r.$selectors.reset(),t=r.get(n[2],e||r.$dom,0,1),t.length&&sr(r,t)),r},reset:function(){var e=this;return e.$memoize.reset(),e.$selectors.reset(),e},on_view_change:function(e,n){var t,r,i,o,u,l,a,s=this,c=s.$model,f=n.el,d={};n.isAutoBind&&(t=f[cn])&&(f[tr]||(f[tr]=c.key(t,1)),r=f[tr],r&&c.has(r)&&(l=f[dn].toLowerCase(),"checkbox"===l?(u=ar.test(t),o=s.get('input[type="checkbox"][name="'+t+'"]'),u?(i=[],nn(o,function(e){e[ln]&&i.push(e[hn])})):o.length>1?(i=[],nn(o,function(e){i.push(e[ln]?e[hn]:(a=e[on]("data-else"))?a:"")})):i=f[ln]?f[hn]:(a=f[on]("data-else"))?a:""):i=Hn(f),d.$trigger=f,c.set(r,i,1,d))),!d.error&&n.isBind&&fr(s,e,[f]),s.publish("change",n)},on_document_keydown:function(e,n){var t,r,i,o,u,l,a,s=this,c=s.$shortcuts,f=n.el;return i="TEXTAREA"===f.tagName?"text":"INPUT"===f.tagName?f[dn].toLowerCase():"",s.$num_shortcuts&&"text"!==i&&"email"!==i&&"url"!==i&&"number"!==i?(u=e.keyCode||e.which,a=[],e.altKey&&a.push("alt"),e.ctrlKey&&a.push("ctrl"),e.metaKey&&a.push("meta"),e.shiftKey&&a.push("shift"),gr[rn](u)?o=gr[u]:(l=188===u?",":190===u?".":b.fromCharCode(u).toLowerCase(),e.shiftKey&&pr[rn](l)&&(l=pr[l]),o=l),o=a.concat(o).join("+"),o&&c[rn](o)&&c[o]&&(t=c[o],r=!0,t.substr?q(s["do_"+t],V)&&(s["do_"+t](e,f,{}),r=!1):r=t.call(s,e,f,{}),!1===r)?(e.stopPropagation(),e.preventDefault(),!1):void 0):void 0},on_model_change:function(e,n){var t,r,i,o=this,u=o.$model,l=o.$autobind,a=!!o.$livebind,s=or(o.$atbind,null,l?[u.id+Ot(n.key)]:0),c="undefined"!=typeof document;c&&(t=o.get(s[0]),l&&(r=o.get(s[2])),n.$callData&&n.$callData.$trigger&&(i=function(e){return e!==n.$callData.$trigger},t=en(t,i),l&&(r=en(r,i)),n.$callData=null)),c&&t.length&&fr(o,e,t,n),c&&l&&r.length&&dr(o,e,r,n),a&&o.$tpl&&hr(o,e,n)},on_model_error:function(e,n){var t,r,i=this,o=i.$model,u=i.$autobind,l=!!i.$livebind,a=or(i.$atbind,null,u?[o.id+Ot(n.key)]:0),s="undefined"!=typeof document;s&&(t=i.get(a[0])).length&&fr(i,e,t,n),s&&u&&(r=i.get(a[2])).length&&dr(i,e,r,n),l&&i.$tpl&&hr(i,e,n)},do_nop:null,do_each:function(){},do_prop:function(e,n,t){if(q(t.prop,H)){var r,i,o,u,l,a=this,s=a.$model,c=t.prop;n=(l=n[on]("data-domref"))?mr.getDomRef(n,l):[n],n&&n.length&&nn(n,function(e){if(e)for(r in c)if(c[rn](r)){if(i=c[r],!s.has(i))continue;switch(o=s.get(i),u=X(o),r){case"value":Vn(e,o);break;case"checked":case"disabled":e[r]=L===u?o:b(o)==e[hn];break;case"options":if("SELECT"===e[fn]&&z===u){var n,t,l=o.length,a="",f=xn("optgroup",e);for(n=Pn(e),f=f.length?f[0]:e,nn(xn("option",f),function(e){f.removeChild(e)}),t=0;l>t;t++)a+=o[t]&&o[t].label?'<option value="'+o[t].value+'">'+o[t].label+"</option>":'<option value="'+o[t]+'">'+o[t]+"</option>";f[$n]=a,zn(e,n)}break;default:e[un](r,o)}}})}},do_html:function(e,n,t){if(t.key){var r,i=this,o=i.$model,u=t.key;n=(r=n[on]("data-domref"))?mr.getDomRef(n,r):[n],n&&n.length&&u&&o.has(u)&&nn(n,function(e){e&&(e[t.text?bn in e?bn:yn:$n]=o.get(u))})}},do_css:function(e,n,t){if(q(t.css,H)){var r,i,o,u,l=this,a=l.$model,s=t.css;n=(u=n[on]("data-domref"))?mr.getDomRef(n,u):[n],n&&n.length&&nn(n,function(e){if(e)for(i in s)s[rn](i)&&(r=s[i],o=a.get(r),o&&(e.style[i]=o))})}},do_set:function(e,n,t){var r,i,o=this,u=o.$model,l=null;t.key?l=t.key:n[cn]&&(n[tr]||(n[tr]=u.key(n[cn],1)),l=n[tr]),l&&(t[rn]("value")?r=t.value:((i=n[on]("data-domref"))&&(n=mr.getDomRef(n,i)[0]),r=Hn(n)),u.set(l,r,1))},do_tpl:function(e,n,t){var r,i,o,u,l=this,a=t.key,s=t.tpl;l.$template&&a&&s&&(r=l.$model,a&&r.has(a)&&(n=(u=n[on]("data-domref"))?mr.getDomRef(n,u):[n],n&&n.length&&(i=t.mode||"replace",o=l.$template(s,r.get(a)),nn(n,function(e){e&&("replace"==i&&(e[$n]=""),o&&(e[$n]+=o))}))))},do_show:function(e,n,t){var r,i,o,u=this,l=u.$model,a=t.key;a&&(n=(i=n[on]("data-domref"))?mr.getDomRef(n,i):[n],n&&n.length&&(r=l.get(a),o=t[rn]("value")?t.value===r:!!r,nn(n,function(e){e&&(o?In(e):Ln(e))})))},do_hide:function(e,n,t){var r,i,o,u=this,l=u.$model,a=t.key;a&&(n=(i=n[on]("data-domref"))?mr.getDomRef(n,i):[n],n&&n.length&&(r=l.get(a),o=t[rn]("value")?t.value===r:!!r,nn(n,function(e){e&&(o?Ln(e):In(e))})))},do_bind:function(e,n,t){var r,i,o,u=this,l=(u.$model,t.name),a=t.key,s=n[dn].toLowerCase();a&&(r=t.value,i=X(r),"radio"===s?b(r)==n[hn]&&(nn(u.get('input[name="'+l+'"]'),function(e){n!==e&&(e[ln]=!1)}),n[ln]=!0):"checkbox"===s?(o=ar.test(l),o?(r=z===i?r:[r],n[ln]=rr(r,n[hn])):n[ln]=z===i?rr(r,n[hn]):L===i?r:b(r)==n[hn]):Vn(n,r))},toString:function(){return"[ModelView.View id: "+this.id+"]"}}),e.ModelView={VERSION:"0.66",UUID:Xn,Extend:tn,Type:bt,Validation:_t,PublishSubscribeInterface:et,Cache:nt,Model:Rt,Tpl:nr,View:mr},!function(e,n){e.jquery=function(n){if(!n.ModelView){n.ModelView=e;var t=(Function.prototype.call.bind(Array.prototype.slice),n.extend),r=e.View,i=e.Model;n.fn.modelview=function(e,o){var u=arguments.length,l=u?e:null,a=e,s=!0,c=!1,f=[];return this.each(function(){var e,d,h,p,g=n(this);if(g.data("modelview")){if(s=!1,d=g.data("modelview"),e=d.$model,"view"===l)f.push(d);else if("model"===l){if(u>1)return d.model(o),this;f.push(e)}else if("data"===l){if(u>1)return e.data(o),this;f.push(e.data())}else"sync"===l?d.sync(o):"reset"===l?d.reset():"dispose"===l&&(g.data("modelview",null),d.dispose());return this}return c||(h={id:"model",data:{},types:{},validators:{},getters:{},setters:{},dependencies:{}},p={viewClass:r,modelClass:i,id:"view",bindAttribute:"data-bind",livebind:null,autobind:!1,isomorphic:!1,bindbubble:!1,autovalidate:!0,events:null,autoSync:!0,cacheSize:r._CACHE_SIZE,refreshInterval:r._REFRESH_INTERVAL,model:null,template:null,actions:{},handlers:{},shortcuts:{}},a=t({},p,a),!a.model||a.model instanceof i||(a.model=t({},h,a.model)),c=!0),a.model?(e=a.model instanceof i?a.model:new a.modelClass(a.model.id,a.model.data,a.model.types,a.model.validators,a.model.getters,a.model.setters,a.model.dependencies),d=new a.viewClass(a.id,e,{bind:a.bindAttribute||"data-bind"},a.cacheSize,a.refreshInterval).template(a.template).events(a.handlers).shortcuts(a.shortcuts).actions(a.actions).livebind(a.livebind).autobind(a.autobind).isomorphic(a.isomorphic).bindbubble(a.bindbubble).autovalidate(a.autovalidate).bind(a.events,g[0]),g.data("modelview",d),void(a.autoSync&&d.sync())):this}),!s&&f.length?1==this.length?f[0]:f:this}}!n.widget||n.mvc&&n.mvc.ModelViewWidget||n.widget("mvc.ModelViewWidget",{options:{},$view:null,_create:function(){var e=this;e.$view=e.element.modelview(e.options).modelview("view")},value:function(e,n){var t=this;return 1<arguments.length?(t.$view.$model.set(e,n,1),t.element):t.$view.$model.get(e)},view:function(){return this.$view},model:function(){return this.$view.$model},_destroy:function(){var e=this.self.$view=null;e.element.modelview("dispose")}})},"undefined"!=typeof n.jQuery&&e.jquery(n.jQuery)}(e.ModelView,this),e.ModelView});