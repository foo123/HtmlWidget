/**
*
* CountDown Timer Widget
*
* adapted from: http://stackoverflow.com/a/20618517/3591273
*/
!function(t){"use strict";function n(t){var n,r,i;return n=t/a|0,t-=n*a,r=t/u|0,t-=r*u,i=t/e|0,t-=i*e,{d:n,h:r,m:i,s:0|t}}function r(t){return t.started=s(),"up"===t.type?function n(){t.running&&(t.time=(s()-t.started)/1e3|0,t.duration>t.time?setTimeout(n,t.granularity):(t.time=t.duration,t.running=!1),t.tick&&t.tick(t))}:function r(){t.running&&(t.time=t.duration-((s()-t.started)/1e3|0),0<t.time?setTimeout(r,t.granularity):(t.time=0,t.running=!1),t.tick&&t.tick(t))}}function i(t,n,r,i){var e=this;e.type=t,e.duration=n,e.granularity=1e3*(r||1),e.started=0,e.time=0,e.tick=i,e.running=!1}var e=60,u=60*e,a=24*u,s=Date.now?Date.now:function(){return(new Date).getTime()},m=/%([^%]+)%/g;i.parse=n,i.prototype={constructor:i,running:!1,type:"down",started:0,duration:0,time:0,granularity:1e3,timer:null,tick:null,dispose:function(){var t=this;return t.type=null,t.duration=null,t.granularity=null,t.started=null,t.time=null,t.timer=null,t.tick=null,t.running=!1,t},start:function(){var t=this;return t.running||(t.timer=r(t),t.running=!0,t.timer()),t},stop:function(){var t=this;return t.running=!1,t},resume:function(){var t=this;return t.timer&&!t.running&&(t.running=!0,t.timer()),t},reset:function(t){var n=this;return n.timer&&(arguments.length&&(n.duration=0|t),n.started=s(),n.running||(n.running=!0,n.timer())),n},getTime:function(){return n(this.time)}};var m=/%([^%]+)%/g;t.Timer=function(n,r){var e,u=this,a=t(n);r=t.extend({format:a.attr("data-timer-format")||"%dd%:%hh%:%mm%:%ss%",type:a.attr("data-timer-type")||"down",duration:parseInt(a.attr("data-timer-duration"),10)||10,granularity:parseInt(a.attr("data-timer-granularity"),10)||1},r||{}),e=r.format,t.data(n,"Timer",u),"function"!=typeof e&&(e=function(t,n){var i=n.getTime();t.html(r.format.replace(m,function(t,n){return"dd"===n?10>i.d?"0"+i.d:i.d:"d"===n?i.d:"hh"===n?10>i.h?"0"+i.h:i.h:"h"===n?i.h:"mm"===n?10>i.m?"0"+i.m:i.m:"m"===n?i.m:"ss"===n?10>i.s?"0"+i.s:i.s:"s"===n?i.s:t}))}),u.dispose=function(){u.tick.dispose(),u.tick=null,t.removeData(n,"Timer")},u.tick=new i(r.type,r.duration,r.granularity,function(t){e(a,t),a.trigger(t.running?"timer-tick":"timer-finished")}),!1!==r.autoStart&&u.tick.start()},t.fn.Timer=function(n){var r=arguments,i=this;return this.each(function(){var e=this,u=t.data(e,"Timer");if(u){if("dispose"===n)u.dispose();else if("start"===n)u.tick.start();else if("stop"===n)u.tick.stop();else if("resume"===n)u.tick.resume();else if("reset"===n)r.length>1?u.tick.reset(r[1]):u.tick.reset();else if("value"===n||"time"===n)return i=u.tick.getTime(),!1}else new t.Timer(e,n)}),i}}(jQuery);