/**
*
* CountDown Timer Widget
* https://github.com/foo123/Timer
*
* adapted from: http://stackoverflow.com/a/20618517/3591273
*/
!function(t){"use strict";function n(t,n){var r=0,i=0,a=0,m=0;return n=n||{days:!0,hours:!0,minutes:!0,seconds:!0},n.days&&(r=t/s|0),t-=r*s,n.hours&&(i=t/u|0),t-=i*u,n.minutes&&(a=t/e|0),t-=a*e,n.seconds&&(m=0|t),{d:r,h:i,m:a,s:m}}function r(t){return t.started=a(),"up"===t.type?function n(){t.running&&(t.time=(a()-t.started)/1e3|0,t.duration>t.time?setTimeout(n,t.granularity):(t.time=t.duration,t.running=!1),t.tick&&t.tick(t))}:function r(){t.running&&(t.time=t.duration-((a()-t.started)/1e3|0),0<t.time?setTimeout(r,t.granularity):(t.time=0,t.running=!1),t.tick&&t.tick(t))}}function i(t,n,r,i){var e=this;e.type=t,e.duration=n,e.granularity=1e3*(r||1),e.started=0,e.time=0,e.tick=i,e.running=!1}var e=60,u=60*e,s=24*u,a=Date.now?Date.now:function(){return(new Date).getTime()},m=/%([^%]+)%/g;i.parse=n,i.prototype={constructor:i,running:!1,type:"down",started:0,duration:0,time:0,granularity:1e3,timer:null,tick:null,dispose:function(){var t=this;return t.type=null,t.duration=null,t.granularity=null,t.started=null,t.time=null,t.timer=null,t.tick=null,t.running=!1,t},start:function(){var t=this;return t.running||(t.timer=r(t),t.running=!0,t.timer()),t},stop:function(){var t=this;return t.running=!1,t},resume:function(){var t=this;return t.timer&&!t.running&&(t.running=!0,t.timer()),t},reset:function(t){var n=this;return n.timer&&(arguments.length&&(n.duration=0|t),n.started=a(),n.running||(n.running=!0,n.timer())),n},getTime:function(t){return n(this.time,t)}};var m=/%([^%]+)%/g;t.Timer=function(n,r){var e,u,s=this,a=t(n);r=r||{};var o=a.attr("data-timer-format")||r.format||"%dd%:%hh%:%mm%:%ss%",d=a.attr("data-timer-type")||r.type||"down",c=parseInt(a.attr("data-timer-duration"),10)||r.duration||10,l=parseInt(a.attr("data-timer-granularity"),10)||r.granularity||1;if(e=o,t.data(n,"Timer",s),"function"!=typeof e){u={days:!1,hours:!1,minutes:!1,seconds:!1},e.replace(m,function(t,n){return"dd"===n||"d"===n?u.days=!0:"hh"===n||"h"===n?u.hours=!0:"mm"===n||"m"===n?u.minutes=!0:("ss"===n||"s"===n)&&(u.seconds=!0),t});var f=a.is("input,textarea")?"val":"html";e=function(t,n){var r=n.getTime(u);t[f](o.replace(m,function(t,n){return"dd"===n?10>r.d?"0"+r.d:r.d:"d"===n?r.d:"hh"===n?10>r.h?"0"+r.h:r.h:"h"===n?r.h:"mm"===n?10>r.m?"0"+r.m:r.m:"m"===n?r.m:"ss"===n?10>r.s?"0"+r.s:r.s:"s"===n?r.s:t}))}}s.dispose=function(){s.tick.dispose(),s.tick=null,t.removeData(n,"Timer")},s.tick=new i(d,c,l,function(t){e(a,t),a.trigger(t.running?"timer-tick":"timer-finished")}),!1!==r.autoStart&&s.tick.start()},t.fn.Timer=function(n){var r=arguments,i=this;return this.each(function(){var e=this,u=t.data(e,"Timer");if(u){if("dispose"===n)u.dispose();else if("start"===n)u.tick.start();else if("stop"===n)u.tick.stop();else if("resume"===n)u.tick.resume();else if("reset"===n)r.length>1?u.tick.reset(r[1]):u.tick.reset();else if("value"===n||"time"===n)return i=u.tick.getTime(),!1}else new t.Timer(e,n)}),i}}(jQuery);