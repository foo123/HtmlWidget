/**
*  area-select.js
*  A simple js class to select rectabgular regions in DOM elements (image, canvas, video, etc..)
*
*  https://github.com/foo123/area-select.js
*
*  @author: Nikos M.  http://nikos-web-development.netai.net/
*
**/!function(e,t){function n(e){var t=document.createElement("div");return e&&(t.className=e),t}function s(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)}function o(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)}function l(e){e.draggable=!1,e.onmousedown=function(e){return e.preventDefault(),!1}}var i=Math.abs,r=Math.round,c=100,u=function(l,i){i=i||{};var u=this;this.element(l),this.selection=null;var f=this.area=n(i.className||"img-area-select");f.style.position="absolute",f.style.display="none",f.style.zIndex=i.zIndex||100,f.style.left="0px",f.style.top="0px",f.style.width="0px",f.style.height="0px",l.parentNode.appendChild(f);var a,h=0,d=0,p=0,y=0,v=0,m=0,x=t!==i.withBorders?i.withBorders:!1,g=function(t){t=t||e.event;var n=u._el,o=n.currentStyle||e.getComputedStyle(n,null),l=x?parseInt(o.borderLeftWidth,10):0,i=x?parseInt(o.borderTopWidth,10):0,r=n.getBoundingClientRect();return p=t.clientX-l-r.left,y=t.clientY-i-r.top,0>p?p=0:p>=n.offsetWidth&&(p=n.offsetWidth-1),0>y?y=0:y>=n.offsetHeight&&(y=n.offsetHeight-1),h=0,d=0,a=n.style.cursor,n.style.cursor=f.style.cursor="se-resize",f.style.display="block",f.style.left=n.offsetLeft-n.scrollLeft+p+"px",f.style.top=n.offsetTop-n.scrollTop+y+"px",f.style.width=h+"px",f.style.height=d+"px",s(n,"mousemove",b),s(n,"mouseup",w),s(f,"mousemove",b),s(f,"mouseup",w),!1},b=function(t){t=t||e.event;var n,s,o=u._el,l=o.currentStyle||e.getComputedStyle(o,null),i=x?parseInt(l.borderLeftWidth,10):0,r=x?parseInt(l.borderTopWidth,10):0,c=o.getBoundingClientRect(),a="e",g="s";return v=t.clientX-i-c.left,m=t.clientY-r-c.top,0>v?v=0:v>=o.offsetWidth&&(v=o.offsetWidth-1),0>m?m=0:m>=o.offsetHeight&&(m=o.offsetHeight-1),p>v?(n=v,f.style.left=o.offsetLeft-o.scrollLeft+v+"px",h=p-v,a="w"):(v==p&&(a=""),n=p,f.style.left=o.offsetLeft-o.scrollLeft+p+"px",h=v-p),y>m?(s=m,f.style.top=o.offsetTop-o.scrollTop+m+"px",d=y-m,g="n"):(m==y&&(g=""),s=y,f.style.top=o.offsetTop-o.scrollTop+y+"px",d=m-y),n+h>o.offsetWidth&&(h=o.offsetWidth-n-1),s+d>o.offsetHeight&&(d=o.offsetHeight-s-1),f.style.width=h+"px",f.style.height=d+"px",o.style.cursor=f.style.cursor=g+a+"-resize",!1},w=function(t){t=t||e.event,u.selection={x1:0,y1:0,x2:0,y2:0},p>v?(u.selection.x1=r(v),u.selection.x2=r(p)):(u.selection.x1=r(p),u.selection.x2=r(v)),y>m?(u.selection.y1=r(m),u.selection.y2=r(y)):(u.selection.y1=r(y),u.selection.y2=r(m)),p=y=v=m=h=d=0;var n=u._el;return n.style.cursor=a,f.style.cursor="auto",o(n,"mousemove",b),o(n,"mouseup",w),o(f,"mousemove",b),o(f,"mouseup",w),u.callback&&setTimeout(function(){u.callback.call(u,u.getSelection())},c),!1};i.onSelection&&this.onSelection(i.onSelection),s(l,"mousedown",g),s(f,"mousedown",g)};u.prototype={constructor:u,_el:null,area:null,selection:null,callback:null,element:function(e){return l(e),this._el=e,this},reset:function(){return this._el=null,this.area=null,this.selection=null,this.callback=null,this},show:function(){return this.area.style.display="block",this},hide:function(){return this.area.style.display="none",this},deselect:function(){return this.selection=null,this.hide()},getSelection:function(){var e=this.selection;return e?{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,width:i(e.x2-e.x1),height:i(e.y2-e.y1)}:null},onSelection:function(e){return this.callback=e,this},dispose:function(){return this.deselect(),this._el.parentNode.removeChild(this.area),this.reset()}},e.AreaSelect=u}(window);