/**
* ColorPicker
* https://github.com/foo123/ColorPicker
* @version 2.1.0
*
* adapted from:
* http://www.eyecon.ro/colorpicker/
*      Color Picker by Stefan Petre www.eyecon.ro (MIT and GPL)
**/
!function(e,t,o){"use strict";"object"==typeof exports?module.exports=o():"function"==typeof define&&define.amd?define(function(e){return o()}):e.ColorPicker=o()}(this,0,function(e){"use strict";var t="hasOwnProperty",o="getAttribute",c=Object.prototype.toString,n=Math.min,r=Math.max,i=Math.round,l=/^\s+|\s+$/g,a=String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(l,"")},u=/\s*,\s*/g,s=0;function d(e){return null!=e&&"[object Array]"===c.call(e)}function h(e,t){return(t||document).getElementById(e)}function p(e,t){return e.classList?e.classList.contains(t):-1!==(" "+e.className+" ").indexOf(" "+t+" ")}function f(e,t){p(e,t)||(e.classList?e.classList.add(t):e.className=""===e.className?t:e.className+" "+t)}function b(e,t){e.classList?e.classList.remove(t):e.className=a((" "+e.className+" ").replace(" "+t+" "," "))}function v(e,t,o){e.attachEvent?e.attachEvent("on"+t,o):e.addEventListener(t,o,!1)}function g(e,t,o){e.detachEvent?e.detachEvent("on"+t,o):e.removeEventListener(t,o,!1)}function m(e,t){var o;document.createEvent?((o=document.createEvent("HTMLEvents")).initEvent(t,!0,!1),e.dispatchEvent(o)):document.createEventObject&&(o=document.createEventObject(),e.fireEvent("on"+t,o))}function _(e,t,o,c){v(c||document,t,function(t){for(var c=!1,n=t.target||t.srcElement;n&&!(c=p(n,e));)n=n.parentElement;c&&o.call(n,t)})}function k(e){var t=0,o=0,c=0,l=e[0],a=e[1],u=e[2],s=n(l,a,u),d=r(l,a,u),h=d-s;return c=d,t=0!=(o=0!=d?255*h/d:0)?l===d?(a-u)/h:a===d?2+(u-l)/h:4+(l-a)/h:-1,(t*=60)<0&&(t+=360),o*=100/255,c*=100/255,[i(t),i(o),i(c)]}function y(e){var t,o,c,n=i(e[0]),r=i(255*e[1]/100),l=i(255*e[2]/100);if(0===r)t=o=c=l;else{var a=(255-r)*l/255,u=n%60*(l-a)/60;360==n&&(n=0),n<60?(t=l,c=a,o=a+u):n<120?(o=l,c=a,t=l-u):n<180?(o=l,t=a,c=a+u):n<240?(c=l,t=a,o=l-u):n<300?(c=l,o=a,t=a+u):n<360?(t=l,o=a,c=l-u):(t=0,o=0,c=0)}return[i(t),i(o),i(c)]}function x(e){var t=[e[0].toString(16),e[1].toString(16),e[2].toString(16)];return 1===t[0].length&&(t[0]="0"+t[0]),1===t[1].length&&(t[1]="0"+t[1]),1===t[2].length&&(t[2]="0"+t[2]),t[0]+t[1]+t[2]}function w(e,t){e.substr&&(e=e.slice(t?5:4,-1).split(u));var o=t?N.opacity(e[3]):null;return[N.hsb[0](e[0]),N.hsb[1](e[1]),N.hsb[2](e[2]),o]}function E(e,t){e.substr&&(e=e.slice(t?5:4,-1).split(u));var o=t?N.opacity(e[3]):null;return[N.rgb[0](e[0]),N.rgb[1](e[1]),N.rgb[2](e[2]),o]}function T(e){return parseInt(e,10)}function C(e,t,o){return"function"==typeof o?function(c){return(c=o(c))>t?t:c<e?e:c}:function(o){return o>t?t:o<e?e:o}}function L(e){var t=e.getBoundingClientRect(),o=document.body,c=window,n=o.clientTop||0,r=o.clientLeft||0,i=c.pageYOffset||o.scrollTop,l=c.pageXOffset||o.scrollLeft;return{top:t.top+i-n,left:t.left+l-r,width:e.offsetWidth,height:e.offsetHeight}}var S,N={opacity:C(0,1,function(e){return parseFloat(e,10)}),hsb:[C(0,360,T),C(0,100,T),C(0,100,T)],rgb:[C(0,255,T),C(0,255,T),C(0,255,T)]},D={hex:(S=/^[0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f]$/i,function(e){return S.test(e)})};function A(e,t,o){var c,n,r,i,l=!0;if(N[t])if(d(c=N[t]))for(r=0,i=c.length;r<i;r++)o[r]=c[r](o[r]);else o=c(o);if(D[t]){if(d(n=D[t])){for(r=0,i=n.length;r<i;r++)if(!n[r](o[r])){l=!1;break}}else n(o)||(l=!1);l&&(e[t]=o)}return l}function O(e,t,o){var c,n,r,i=!1;return null!=o&&(e.opacity=N.opacity(o),i=!0),t&&(d(t)?(3<t.length&&(o=t[3],t=t.slice(0,3)),A(e,"rgb",t)&&(null!=o&&(e.opacity=N.opacity(o)),H(e,"rgb"),i=!0)):t.substr&&("rgba"===t.slice(0,4)?(c=E(t,!0),e.rgb=[c[0],c[1],c[2]],e.opacity=N.opacity(c[3]),H(e,"rgb"),i=!0):"rgb"===t.slice(0,3)?(c=E(t),e.rgb=[c[0],c[1],c[2]],H(e,"rgb"),i=!0):"hsla"===t.slice(0,4)?(c=w(t,!0),e.hsb=[c[0],c[1],c[2]],e.opacity=N.opacity(c[3]),H(e,"hsb"),i=!0):"hsl"===t.slice(0,3)?(c=w(t),e.hsb=[c[0],c[1],c[2]],H(e,"hsb"),i=!0):A(e,"hex",((r=6-(n="#"===(n=t).charAt(0)?n.slice(1):n).length)>0&&(n=3===r?n.charAt(0)+n.charAt(0)+n.charAt(1)+n.charAt(1)+n.charAt(2)+n.charAt(2):new Array(r+1).join("0")+n),n))&&(H(e,"hex"),i=!0))),i}function Y(e,t){return"rgba"===t?"rgba("+e.rgb[0]+","+e.rgb[1]+","+e.rgb[2]+","+e.opacity+")":"rgb"===t?"rgb("+e.rgb[0]+","+e.rgb[1]+","+e.rgb[2]+")":"hsla"===t?"hsla("+e.hsb[0]+","+e.hsb[1]+"%,"+e.hsb[2]+"%,"+e.opacity+")":"hsl"===t?"hsl("+e.hsb[0]+","+e.hsb[1]+"%,"+e.hsb[2]+"%)":"#"+e.hex}function H(e,t){var o;"hsb"===t?(e.rgb=y(e.hsb),e.hex=x(e.rgb)):"rgb"===t?(e.hsb=k(e.rgb),e.hex=x(e.rgb)):"hex"===t&&(e.rgb=(o=e.hex,[(o=parseInt(o,16))>>16&255,o>>8&255,255&o]),e.hsb=k(e.rgb))}function P(e,t,o){var c=e.rgb,n=e.hsb,r=e.opacity,i=e.hex,l="rgba("+c[0]+","+c[1]+","+c[2]+","+r+")",a="rgb("+y([n[0],100,100]).join(",")+")";t.hsb[0].value=n[0],t.hsb[1].value=n[1],t.hsb[2].value=n[2],t.rgb[0].value=c[0],t.rgb[1].value=c[1],t.rgb[2].value=c[2],t.hex.value=i,t.hue.style.backgroundColor=a,t.indic_sb.style.top=150*(100-n[2])/100+"px",t.indic_sb.style.left=150*n[1]/100+"px",t.indic_hue.style.top=148-148*n[0]/360+"px",t.color_new.style.backgroundColor=l,o&&(t.color_current.style.backgroundColor=l)}function j(e,t,o,c){var n=e===t;e&&(e.selectedColor=o,e.style.backgroundColor=o,n&&(t.value=o),c&&m(e,c),n&&"change"!==c&&m(t,"change")),t&&!n&&(t.value=o,m(t,"change"))}function z(){}function M(e){return function(e,o){for(var c in o)o[t](c)&&(e[c]=o[c]);return e}({input:null,selector:null,format:"rgba",color:"ff0000",opacity:1,changeEvent:"colorchange",bindEvent:"click",onSelect:z,onBeforeShow:z,onShow:z,onHide:z,livePreview:!0},e||{})}function B(e,t){var c,l,a,u,d,m,k,y,x,w,E,C,S,N,D,A,z,I,W,X,R,$=this,F=0,V=0,q=0,G=null;if(!($ instanceof B))return new B(e,t);D=function(e){if(27===e.keyCode)return N(!0)},N=function o(c){var n=!0===c||(c.target||c.srcElement);p(a,"colorpicker-visible")&&(!0===n||n!==e&&!function(e,t,o){if(e===t)return!0;if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return!!(16&e.compareDocumentPosition(t));for(var c=t.parentNode;c&&c!==o;){if(c===e)return!0;c=c.parentNode}return!1}(a,n,a))&&(b(a,"colorpicker-visible"),g(document,"keyup",D),g(document,"mousedown",o),g(document,"touchstart",o),t.onHide($))},S=function(e){if(!p(a,"colorpicker-visible")){t.onBeforeShow($);var o=L(e.target||e.srcElement),c=(i="CSS1Compat"==document.compatMode,{l:window.pageXOffset||(i?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(i?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(i?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(i?document.documentElement.clientHeight:document.body.clientHeight)}),n=o.top+o.height,r=o.left;n+176>c.t+c.h&&(n-=o.height+176),r+356>c.l+c.w&&(r-=356),a.style.left=r+"px",a.style.top=n+"px",f(a,"colorpicker-visible"),v(document,"keyup",D),v(document,"mousedown",N),v(document,"touchstart",N),t.onShow($)}var i;return!1},u=function(e){if(!F){e.preventDefault();var t=(e.target||e.srcElement).parentNode,c=t.children[0],n=t[o]("data-field"),r=n.slice(0,3);G={el:t,field:c,type:n,key:r,index:T(n.slice(-1)),max:"hsb.0"===n?360:"hsb"===r?100:255,val:T(c.value),y:e.changedTouches&&e.changedTouches.length?e.changedTouches[0].pageY:e.pageY},f(t,"colorpicker_slider"),c.focus(),F=1,v(document,"mouseup",m),v(document,"mousemove",d),v(document,"touchend",m),v(document,"touchcancel",m),v(document,"touchmove",d)}},d=function(e){e.preventDefault();var o=G.key,c=G.index,i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0].pageY:e.pageY;return A[o][c]=r(0,n(G.max,T(G.val+i-G.y))),t.livePreview&&(H(A,o),P(A,z)),!1},m=function(e){return e.preventDefault(),g(document,"mouseup",m),g(document,"mousemove",d),g(document,"touchend",m),g(document,"touchcancel",m),g(document,"touchmove",d),H(A,G.key),P(A,z),b(G.el,"colorpicker_slider"),G.field.focus(),F=0,G=null,!1},k=function(e){if(!V){e.preventDefault();var t=e.target||e.srcElement;G={y:L(t).top},V=1,v(document,"mouseup",x),v(document,"mousemove",y),v(document,"touchend",x),v(document,"touchcancel",x),v(document,"touchmove",y)}},y=function(e){e.preventDefault();var o=e.changedTouches&&e.changedTouches.length?e.changedTouches[0].pageY:e.pageY;return A.hsb[0]=i(360*(148-r(0,n(148,o-G.y)))/148),t.livePreview&&(H(A,"hsb"),P(A,z)),!1},x=function(e){return e.preventDefault(),g(document,"mouseup",x),g(document,"mousemove",y),g(document,"touchend",x),g(document,"touchcancel",x),g(document,"touchmove",y),H(A,"hsb"),P(A,z),V=0,G=null,!1},w=function(e){if(!q){e.preventDefault();var t=e.target||e.srcElement;G=L(t),q=1,v(document,"mouseup",C),v(document,"mousemove",E),v(document,"touchend",C),v(document,"touchcancel",C),v(document,"touchmove",E)}},E=function(e){e.preventDefault();var o=e.changedTouches&&e.changedTouches.length?e.changedTouches[0].pageX:e.pageX,c=e.changedTouches&&e.changedTouches.length?e.changedTouches[0].pageY:e.pageY;return A.hsb[1]=i(100*r(0,n(150,o-G.left))/150),A.hsb[2]=i(100*(150-r(0,n(150,c-G.top)))/150),t.livePreview&&(H(A,"hsb"),P(A,z)),!1},C=function(e){return e.preventDefault(),g(document,"mouseup",C),g(document,"mousemove",E),g(document,"touchend",C),g(document,"touchcancel",C),g(document,"touchmove",E),H(A,"hsb"),P(A,z),q=0,G=null,!1},$.dispose=function(){$.ui=null,p(a,"colorpicker-flat")||g(e,t.bindEvent,S),a.parentNode.removeChild(a)},$.setColor=function(e,t){O(A,e,t)&&P(A,z,!0)},$.getColor=function(e){return Y(A,e||I)},$.value=function(e,t){if(!arguments.length)return Y(A,I);O(A,e,t)&&P(A,z,!0)},t=M(t),I=e[o]("data-color-format")||t.format||"rgba",W=e[o]("data-color-change")||t.changeEvent,X=e[o]("data-color-selector")?h(e[o]("data-color-selector")):t.selector||(p(e,"colorpicker-selector")?e:null),R=e[o]("data-color-input")?h(e[o]("data-color-input")):t.input||("input"===(e.tagName||"").toLowerCase()?e:null),l=t.id||"colorpicker_ui_"+ ++s;var J=document.createElement("div");J.innerHTML=function(e){return'<div id="'+e+'" class="colorpicker">    <div id="'+e+'_satur_bright" class="colorpicker_satur_bright"><div id="'+e+'_satur_bright_indic"></div></div>    <div id="'+e+'_hue" class="colorpicker_hue"><div id="'+e+'_hue_indic"></div></div>    <div class="colorpicker_new_color colorpicker_transparent">    <button id="'+e+'_new_color" class="colorpicker_color colorpicker_save"></button>    </div>    <div class="colorpicker_current_color colorpicker_transparent">    <button id="'+e+'_current_color" class="colorpicker_color colorpicker_restore"></button>    </div>    <div class="colorpicker_field" data-field="hex">    <input id="'+e+'_hex" type="text" maxlength="6" size="6" value=""/>    <div class="colorpicker_field_back"></div>    </div>    <div class="colorpicker_field" data-field="rgb.0">    <input id="'+e+'_rgb_0" type="text" maxlength="3" size="3" value=""/><span class="colorpicker_increment"></span>    <div class="colorpicker_field_back"></div>    </div>    <div class="colorpicker_field" data-field="rgb.1">    <input id="'+e+'_rgb_1" type="text" maxlength="3" size="3" value=""/><span class="colorpicker_increment"></span>    <div class="colorpicker_field_back"></div>    </div>    <div class="colorpicker_field" data-field="rgb.2">    <input id="'+e+'_rgb_2" type="text" maxlength="3" size="3" value=""/><span class="colorpicker_increment"></span>    <div class="colorpicker_field_back"></div>    </div>    <div class="colorpicker_field" data-field="hsb.0">    <input id="'+e+'_hsb_0" type="text" maxlength="3" size="3" value=""/><span class="colorpicker_increment"></span>    <div class="colorpicker_field_back"></div>    </div>    <div class="colorpicker_field" data-field="hsb.1">    <input id="'+e+'_hsb_1" type="text" maxlength="3" size="3" value=""/><span class="colorpicker_increment"></span>    <div class="colorpicker_field_back"></div>    </div>    <div class="colorpicker_field" data-field="hsb.2">    <input id="'+e+'_hsb_2" type="text" maxlength="3" size="3" value=""/><span class="colorpicker_increment"></span>    <div class="colorpicker_field_back"></div>    </div>    <button id="'+e+'_submit" class="colorpicker_submit colorpicker_save"></button>    </div>'}(l),J.style.display="none",document.body.appendChild(J),a=h(l),A={opacity:1,hsb:[0,0,0],rgb:[0,0,0],hex:"000000"},(z={hsb:[h(l+"_hsb_0"),h(l+"_hsb_1"),h(l+"_hsb_2")],rgb:[h(l+"_rgb_0"),h(l+"_rgb_1"),h(l+"_rgb_2")],hex:h(l+"_hex"),hue:h(l+"_satur_bright"),indic_hue:h(l+"_hue_indic"),indic_sb:h(l+"_satur_bright_indic"),color_new:h(l+"_new_color"),color_current:h(l+"_current_color")}).indic_hue.style.top="0px",z.indic_sb.style.left="0px",z.indic_sb.style.top="0px",_("colorpicker_satur_bright","touchstart",w,a),_("colorpicker_hue","touchstart",k,a),_("colorpicker_increment","touchstart",u,a),_("colorpicker_satur_bright","mousedown",w,a),_("colorpicker_hue","mousedown",k,a),_("colorpicker_increment","mousedown",u,a),_("colorpicker_save","click",function(){c=A.rgb.slice(),P(A,z,!0),N&&N(!0),j(X,R,Y(A,I),W)},a),_("colorpicker_restore","click",function(){A.rgb=c.slice(),H(A,"rgb"),P(A,z)},a),$.ui=a,O(A,e[o]("data-color")||t.color,e[o]("data-opacity")||t.opacity),c=A.rgb.slice(),P(A,z,!0),p(e,"colorpicker-flat")?(f(a,"colorpicker-flat"),a.style.display="block",e.appendChild(a)):(document.body.appendChild(a),v(e,t.bindEvent,S),j(X,R,Y(A,I))),document.body.removeChild(J),J=null,p(e,"colorpicker-light")&&f(a,"colorpicker-light"),p(e,"colorpicker-dark")&&f(a,"colorpicker-dark"),p(e,"colorpicker-transition-fade")&&f(a,"colorpicker-transition-fade"),p(e,"colorpicker-transition-slide")&&f(a,"colorpicker-transition-slide")}return B.VERSION="2.1.0",B});